<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BMLT Root Server: /Volumes/Development/webroot/web_projects/BMLT-Root-Server/main_server/local_server/server_admin/c_comdef_admin_xml_handler.class.php Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BMLT Root Server
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_26d822986ba68053f2c860363e4e8d8e.html">main_server</a></li><li class="navelem"><a class="el" href="../../dir_679ab5230e056b8c3cd4060cabb17f72.html">local_server</a></li><li class="navelem"><a class="el" href="../../dir_96bd026b69dcda7c1eff983b496c9708.html">server_admin</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">c_comdef_admin_xml_handler.class.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;?php</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">    This file is part of the Basic Meeting List Toolbox (BMLT).</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">    Find out more at: https://bmlt.app</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">    BMLT is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">    it under the terms of the MIT License.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">    BMLT is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">    MIT License for more details.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">    You should have received a copy of the MIT License along with this code.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">    If not, see &lt;https://opensource.org/licenses/MIT&gt;.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<a class="code" href="../../d5/d1d/client__interface_2html_2index_8php.html#a9fbaf120043298ee46edd0722ca2d570">defined</a>(<span class="stringliteral">&#39;BMLT_EXEC&#39;</span>) or die(&#39;Cannot Execute Directly&#39;);    <span class="comment">// Makes sure that this file is in the correct context.</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/***********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">    \class c_comdef_admin_xml_handler</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">    \brief Controls handling of the admin semantic interface.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">            This class should not even be instantiated unless the user has been authorized, and an authorized seesion</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">            is in progress.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">***************************************************************************************************************/</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// phpcs:disable PSR1.Classes.ClassDeclaration.MissingNamespace</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// phpcs:disable Squiz.Classes.ValidClassName.NotCamelCaps</span></div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html">   28</a></span>&#160;class <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html">c_comdef_admin_xml_handler</a></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// phpcs:enable PSR1.Classes.ClassDeclaration.MissingNamespace</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// phpcs:enable Squiz.Classes.ValidClassName.NotCamelCaps</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a634e4fb3f0535a99050530167407ff87">   32</a></span>&#160;    <span class="keyword">public</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a634e4fb3f0535a99050530167407ff87">$http_vars</a>;                     <span class="comment">///&lt; This will hold the combined GET and POST parameters for this call.</span></div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ad135cc8a47e55f0829949cf62214170f">   33</a></span>&#160;<span class="comment"></span>    <span class="keyword">public</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ad135cc8a47e55f0829949cf62214170f">$server</a>;                        <span class="comment">///&lt; The BMLT server model instance.</span></div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a42027b0fdb84434834455b4606d1b74e">   34</a></span>&#160;<span class="comment"></span>    <span class="keyword">public</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a42027b0fdb84434834455b4606d1b74e">$my_localized_strings</a>;          <span class="comment">///&lt; An array of localized strings.</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a4fc8d3a76e1dc1b940621027fadc4dd4">   35</a></span>&#160;<span class="comment"></span>    <span class="keyword">public</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a4fc8d3a76e1dc1b940621027fadc4dd4">$handled_service_body_ids</a>;      <span class="comment">///&lt; This is used to ensure that we respect the hierarchy when doing a hierarchical Service body request.</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span>    </div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">    \brief The class constructor.</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a751759217c4c0c786276ee28ac1558d4">   40</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a751759217c4c0c786276ee28ac1558d4">__construct</a>(</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        $in_http_vars,        <span class="comment">///&lt; The combined GET and POST parameters.</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span>        $in_server            <span class="comment">///&lt; The BMLT server instance.</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"></span>    ) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        $this-&gt;http_vars = $in_http_vars;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        $this-&gt;server = $in_server;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        $this-&gt;my_localized_strings = <a class="code" href="../../dd/d45/classc__comdef__server.html#af8fe64ccd359a4877fc04cd52ac9b938">c_comdef_server::GetLocalStrings</a>();</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        $this-&gt;handled_service_body_ids = array();</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">    \brief This returns the URL to the main server. It needs extra stripping, because we&#39;re depper than usual.</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">    \returns the URL.</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a357d66d273dc1787a841e738668ba14e">   56</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a357d66d273dc1787a841e738668ba14e">getMainURL</a>()</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">return</span> dirname(dirname(<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a2b4b5d31847b34fe2fe62cf560342d01">GetURLToMainServerDirectory</a>(<span class="keyword">false</span>))).<span class="charliteral">&#39;/&#39;</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    </div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">    \brief This extracts a meeting&#39;s essential data as XML.</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">    \returns the XML for the meeting data.</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a7801e378d1267edc99d11e029f208acb">   68</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a7801e378d1267edc99d11e029f208acb">get_meeting_data</a>(<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        </div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        $meeting_object = <a class="code" href="../../dd/d45/classc__comdef__server.html#a1ed8d51fee14cd90a6bd9915580317b1">c_comdef_server::GetOneMeeting</a>(<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        </div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span> (($meeting_object instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>) &amp;&amp; (intval($meeting_object-&gt;GetID()) == intval(<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>))) {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            $localized_strings = <a class="code" href="../../dd/d45/classc__comdef__server.html#af8fe64ccd359a4877fc04cd52ac9b938">c_comdef_server::GetLocalStrings</a>();</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a> = $meeting_object-&gt;GetID();</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            $weekday_tinyint = intval($meeting_object-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;weekday_tinyint&#39;</span>));</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            $weekday_name = $localized_strings[<span class="stringliteral">&quot;comdef_server_admin_strings&quot;</span>][<span class="stringliteral">&quot;meeting_search_weekdays_names&quot;</span>][$weekday_tinyint];</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            $start_time = $meeting_object-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;start_time&#39;</span>);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            $meeting_name = str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $meeting_object-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;meeting_name&#39;</span>))));</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            $meeting_borough = str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $meeting_object-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;location_city_subsection&#39;</span>))));</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            $meeting_town = str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $meeting_object-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;location_municipality&#39;</span>))));</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            $meeting_state = str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $meeting_object-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;location_province&#39;</span>))));</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&quot;meeting_id&quot;,&quot;meeting_name&quot;,&quot;weekday_tinyint&quot;,&quot;weekday_name&quot;,&quot;start_time&quot;,&quot;location_city_subsection&quot;,&quot;location_municipality&quot;,&quot;location_province&quot;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                $change_line[<span class="stringliteral">&#39;meeting_id&#39;</span>] = <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                $change_line[<span class="stringliteral">&#39;meeting_id&#39;</span>] = 0;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="keywordflow">if</span> ($meeting_name) {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                $change_line[<span class="stringliteral">&#39;meeting_name&#39;</span>] = $meeting_name;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                $change_line[<span class="stringliteral">&#39;meeting_name&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">if</span> ($weekday_tinyint) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                $change_line[<span class="stringliteral">&#39;weekday_tinyint&#39;</span>] = $weekday_tinyint;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                $change_line[<span class="stringliteral">&#39;weekday_tinyint&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="keywordflow">if</span> ($weekday_name) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                $change_line[<span class="stringliteral">&#39;weekday_name&#39;</span>] = $weekday_name;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                $change_line[<span class="stringliteral">&#39;weekday_name&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordflow">if</span> ($start_time) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                $change_line[<span class="stringliteral">&#39;start_time&#39;</span>] = $start_time;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                $change_line[<span class="stringliteral">&#39;start_time&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordflow">if</span> ($meeting_borough) {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                $change_line[<span class="stringliteral">&#39;location_city_subsection&#39;</span>] = $meeting_borough;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                $change_line[<span class="stringliteral">&#39;location_city_subsection&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">if</span> ($meeting_town) {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                $change_line[<span class="stringliteral">&#39;location_municipality&#39;</span>] = $meeting_town;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                $change_line[<span class="stringliteral">&#39;location_municipality&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">if</span> ($meeting_state) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                $change_line[<span class="stringliteral">&#39;location_province&#39;</span>] = $meeting_state;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                $change_line[<span class="stringliteral">&#39;location_province&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            </div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="charliteral">&#39;&quot;&#39;</span>.implode(<span class="stringliteral">&#39;&quot;,&quot;&#39;</span>, $change_line).<span class="charliteral">&#39;&quot;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;TranslateCSVToXML(<a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;meeting xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/RestoreDeletedMeeting.php\&quot;&gt;$ret&lt;/meeting&gt;&quot;</span>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;PROGRAM ERROR (MEETING FETCH FAILED)&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        </div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    </div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">    \brief This is called to process the input and generate the output. It is the &quot;heart&quot; of the class.</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">    \returns XML to be returned.</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a166dfd988cdd152db9f360e09c040db8">  152</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a166dfd988cdd152db9f360e09c040db8">process_commands</a>()</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = null;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment">// We make sure that we are allowed to access this level of functionality.</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="comment">// This is &quot;belt and suspenders.&quot; We will constantly check user credentials.</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;http_vars[<span class="stringliteral">&#39;admin_action&#39;</span>]) &amp;&amp; trim($this-&gt;http_vars[<span class="stringliteral">&#39;admin_action&#39;</span>])) {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                set_time_limit(120); <span class="comment">// Some requests can take a loooong time...</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="keywordflow">switch</span> (strtolower(trim($this-&gt;http_vars[<span class="stringliteral">&#39;admin_action&#39;</span>]))) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;get_permissions&#39;</span>:</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_capabilities_request();</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    </div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;get_service_body_info&#39;</span>:</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_service_bodies_info_request();</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    </div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;get_format_info&#39;</span>:</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_format_info();</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    </div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;get_field_templates&#39;</span>:</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_get_field_templates();</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    </div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;get_meetings&#39;</span>:</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_meeting_search();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    </div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;get_deleted_meetings&#39;</span>:</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_deleted_meetings();</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    </div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;get_changes&#39;</span>:</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_changes();</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    </div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;add_meeting&#39;</span>:</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                        $this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>] = 0;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                        unset($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]);    <span class="comment">// Make sure that we have no meeting ID. This forces an add.</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_meeting_modify();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    </div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;rollback_meeting_to_before_change&#39;</span>:</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        <span class="keywordflow">if</span> (intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) &amp;&amp;  intval($this-&gt;http_vars[<span class="stringliteral">&#39;change_id&#39;</span>])) {    <span class="comment">// Make sure that we are referring to a meeting and a change.</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_rollback_meeting();</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;BAD ADMIN ACTION&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                        }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    </div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;restore_deleted_meeting&#39;</span>:</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                        <span class="keywordflow">if</span> (intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>])) {    <span class="comment">// Make sure that we are referring to a meeting</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_restore_deleted_meeting();</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;BAD ADMIN ACTION&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                        }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    </div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;modify_meeting&#39;</span>:</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                        <span class="keywordflow">if</span> (intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>])) {    <span class="comment">// Make sure that we are referring to a meeting.</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_meeting_modify();</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;BAD ADMIN ACTION&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                        }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    </div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;delete_meeting&#39;</span>:</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                        <span class="keywordflow">if</span> (intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>])) {    <span class="comment">// Make sure that we are referring to a meeting</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_meeting_delete();</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;BAD ADMIN ACTION&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                        }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;get_user_info&#39;</span>:</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;process_user_info();</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;BAD ADMIN ACTION&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                </div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                set_time_limit(30); <span class="comment">// Probably unnecessary...</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;BAD ADMIN ACTION&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    </div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">    \brief This is a basic funtion that tests the current user, to see if they are basically valid.</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">    \returns TRUE, if the user is valid.</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ad530d8c4d6f9b53b9ce180cd8cacdf39">  254</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ad530d8c4d6f9b53b9ce180cd8cacdf39">basic_user_validation</a>()</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        </div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        $user_obj = $this-&gt;server-&gt;GetCurrentUserObj();</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="comment">// First, make sure the use is of the correct general type.</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> (isset($user_obj) &amp;&amp; ($user_obj instanceof <a class="code" href="../../d4/de6/classc__comdef__user.html">c_comdef_user</a>) &amp;&amp; ($user_obj-&gt;GetUserLevel() != <a class="code" href="../../df/d40/c__comdef__user_8class_8php.html#a65106dc8c1c3bcd5c97f95a66caccf51">_USER_LEVEL_DISABLED</a>) &amp;&amp; ($user_obj-&gt;GetUserLevel() != <a class="code" href="../../df/d40/c__comdef__user_8class_8php.html#a45f118b0120941c6f0099e0467bea854">_USER_LEVEL_SERVER_ADMIN</a>) &amp;&amp; ($user_obj-&gt;GetID() &gt; 1)) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        </div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    </div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">    \brief This fulfills a user request to get change records.</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">    \returns the XML for the change data.</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#acb6ac99c5ba9e91df910bb9febaec2b6">  274</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#acb6ac99c5ba9e91df910bb9febaec2b6">process_changes</a>()</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment">// First, make sure the use is of the correct general type.</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            $start_date = (isset($this-&gt;http_vars[<span class="stringliteral">&#39;from_date&#39;</span>]) &amp;&amp; $this-&gt;http_vars[<span class="stringliteral">&#39;from_date&#39;</span>]) ? strtotime($this-&gt;http_vars[<span class="stringliteral">&#39;from_date&#39;</span>]) : (isset($this-&gt;http_vars[<span class="stringliteral">&#39;start_date&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;start_date&#39;</span>]) ? intval($this-&gt;http_vars[<span class="stringliteral">&#39;start_date&#39;</span>]) : null);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            $end_date = (isset($this-&gt;http_vars[<span class="stringliteral">&#39;to_date&#39;</span>]) &amp;&amp; $this-&gt;http_vars[<span class="stringliteral">&#39;to_date&#39;</span>]) ? strtotime($this-&gt;http_vars[<span class="stringliteral">&#39;to_date&#39;</span>]) : (isset($this-&gt;http_vars[<span class="stringliteral">&#39;end_date&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;end_date&#39;</span>]) ? intval($this-&gt;http_vars[<span class="stringliteral">&#39;end_date&#39;</span>]) : null);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a> = isset($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) ? intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) : null;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            $user_id = isset($this-&gt;http_vars[<span class="stringliteral">&#39;user_id&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;user_id&#39;</span>]) ? intval($this-&gt;http_vars[<span class="stringliteral">&#39;user_id&#39;</span>]) : null;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            $service_body_id = null;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            </div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;http_vars[<span class="stringliteral">&#39;service_body_id&#39;</span>])) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                $service_body_array = explode(<span class="stringliteral">&quot;,&quot;</span>, $this-&gt;http_vars[<span class="stringliteral">&#39;service_body_id&#39;</span>]);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                </div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="keywordflow">foreach</span> ($service_body_array as $sb) {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    $sb_int = intval($sb);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    </div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    <span class="keywordflow">if</span> ($sb_int &gt; 0) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                        $sb_obj = <a class="code" href="../../dd/d45/classc__comdef__server.html#aac85daa361f03562762940c543139cc5">c_comdef_server::GetServiceBodyByIDObj</a>($sb_int);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                        </div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                        <span class="keywordflow">if</span> ($sb_obj instanceof <a class="code" href="../../d1/dff/classc__comdef__service__body.html">c_comdef_service_body</a>) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                            <span class="keywordflow">if</span> ($sb_obj-&gt;UserCanObserve()) {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                <span class="keywordflow">if</span> (!isset($service_body_id)) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                    $service_body_id = $sb_int;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                } elseif (!is_array($service_body_id)) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                    $service_body_id = array ( $service_body_id, $sb_int );</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                    $service_body_id[] = $sb_int;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                            }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                        }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            </div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="comment">// We get the changes as CSV, then immediately turn them into XML.</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;TranslateCSVToXML($this-&gt;get_changes_as_csv($start_date, $end_date, <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>, $user_id, $service_body_id));</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;changes xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/GetChanges.php\&quot;&gt;$ret&lt;/changes&gt;&quot;</span>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        </div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    </div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">    \brief This fulfills a user request to restore a single deleted meeting.</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">    \returns the current meeting XML, if the rollback was successful.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a0de444c38e9d5a1bf397ba278318b993">  325</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a0de444c38e9d5a1bf397ba278318b993">process_rollback_meeting</a>()</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        </div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="comment">// First, make sure the user is of the correct general type.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;PROGRAM ERROR (ROLLBACK FAILED)&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            </div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a> = isset($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) ? intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) : null;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            $change_id = isset($this-&gt;http_vars[<span class="stringliteral">&#39;change_id&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;change_id&#39;</span>]) ? intval($this-&gt;http_vars[<span class="stringliteral">&#39;change_id&#39;</span>]) : null;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            </div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a> &amp;&amp; $change_id) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                $change_objects = <a class="code" href="../../dd/d45/classc__comdef__server.html#aebc5d4fd6276a2a70fbbe1f7950ab356">c_comdef_server::GetChangesFromIDAndType</a>(<span class="stringliteral">&#39;c_comdef_meeting&#39;</span>, <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                </div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="keywordflow">if</span> ($change_objects instanceof <a class="code" href="../../d2/d5a/classc__comdef__changes.html">c_comdef_changes</a>) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    $obj_array = $change_objects-&gt;GetChangesObjects();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            </div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                    <span class="keywordflow">if</span> (is_array($obj_array) &amp;&amp; count($obj_array)) {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                        <span class="keywordflow">foreach</span> ($obj_array as $change) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                            <span class="keywordflow">if</span> ($change-&gt;GetID() == $change_id) {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                $beforeMeetingObject = $change-&gt;GetBeforeObject();</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                <span class="keywordflow">if</span> ($beforeMeetingObject) {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                    $currentMeetingObject = <a class="code" href="../../dd/d45/classc__comdef__server.html#a1ed8d51fee14cd90a6bd9915580317b1">c_comdef_server::GetOneMeeting</a>(<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                </div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                    <span class="keywordflow">if</span> (($beforeMeetingObject instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>) &amp;&amp; ($currentMeetingObject instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>)) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                        <span class="keywordflow">if</span> ($currentMeetingObject-&gt;UserCanEdit() &amp;&amp; $beforeMeetingObject-&gt;UserCanEdit()) {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                            <span class="keywordflow">if</span> ($change-&gt;Rollback()) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                                $meeting_object = <a class="code" href="../../dd/d45/classc__comdef__server.html#a1ed8d51fee14cd90a6bd9915580317b1">c_comdef_server::GetOneMeeting</a>(<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                            </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;get_meeting_data(<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                            }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                        }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                    }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                </div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                            }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                        }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                    }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            </div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    </div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">    \brief This fulfills a user request to restore a single deleted meeting.</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">    \returns the XML for the meeting data.</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a87ee72103e36de70b6e65c83b84fb7de">  378</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a87ee72103e36de70b6e65c83b84fb7de">process_restore_deleted_meeting</a>()</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        </div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="comment">// First, make sure the user is of the correct general type.</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a> = isset($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) ? intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) : null;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            </div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>) {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                $change_objects = <a class="code" href="../../dd/d45/classc__comdef__server.html#aebc5d4fd6276a2a70fbbe1f7950ab356">c_comdef_server::GetChangesFromIDAndType</a>(<span class="stringliteral">&#39;c_comdef_meeting&#39;</span>, <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                </div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="keywordflow">if</span> ($change_objects instanceof <a class="code" href="../../d2/d5a/classc__comdef__changes.html">c_comdef_changes</a>) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    $obj_array = $change_objects-&gt;GetChangesObjects();</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            </div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    <span class="keywordflow">if</span> (is_array($obj_array) &amp;&amp; count($obj_array)) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        <span class="keywordflow">foreach</span> ($obj_array as $change) {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                            <span class="keywordflow">if</span> ($change instanceof <a class="code" href="../../d5/d79/classc__comdef__change.html">c_comdef_change</a>) {</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                <span class="keywordflow">if</span> ($change-&gt;GetAfterObject()) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                </div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                $unrestored_meeting_object = $change-&gt;GetBeforeObject();</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                            </div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                <span class="keywordflow">if</span> ($unrestored_meeting_object-&gt;UserCanEdit()) {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                    $unrestored_meeting_object-&gt;SetPublished(<span class="keyword">false</span>); <span class="comment">// Newly restored meetings are always unpublished.</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                    $unrestored_meeting_object-&gt;UpdateToDB();</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;get_meeting_data(<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;PROGRAM ERROR (NO VALID CHANGE RECORD)&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                            }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NO MEETING AVAILABLE&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NO MEETING AVAILABLE&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NO MEETING SPECIFIED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        </div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    </div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">    \brief This fulfills a user request to delete a meeting.</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">    \returns the XML for the meeting data.</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00436"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ab2e4b3bdd2476f154bb881345ac2208a">  436</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ab2e4b3bdd2476f154bb881345ac2208a">process_deleted_meetings</a>()</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    {</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        </div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="comment">// First, make sure the user is of the correct general type.</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            $start_date = (isset($this-&gt;http_vars[<span class="stringliteral">&#39;from_date&#39;</span>]) &amp;&amp; $this-&gt;http_vars[<span class="stringliteral">&#39;from_date&#39;</span>]) ? strtotime($this-&gt;http_vars[<span class="stringliteral">&#39;from_date&#39;</span>]) : (isset($this-&gt;http_vars[<span class="stringliteral">&#39;start_date&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;start_date&#39;</span>]) ? intval($this-&gt;http_vars[<span class="stringliteral">&#39;start_date&#39;</span>]) : null);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            $end_date = (isset($this-&gt;http_vars[<span class="stringliteral">&#39;to_date&#39;</span>]) &amp;&amp; $this-&gt;http_vars[<span class="stringliteral">&#39;to_date&#39;</span>]) ? strtotime($this-&gt;http_vars[<span class="stringliteral">&#39;to_date&#39;</span>]) : (isset($this-&gt;http_vars[<span class="stringliteral">&#39;end_date&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;end_date&#39;</span>]) ? intval($this-&gt;http_vars[<span class="stringliteral">&#39;end_date&#39;</span>]) : null);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a> = isset($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) ? intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]) : null;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            $user_id = isset($this-&gt;http_vars[<span class="stringliteral">&#39;user_id&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;user_id&#39;</span>]) ? intval($this-&gt;http_vars[<span class="stringliteral">&#39;user_id&#39;</span>]) : null;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            $service_body_id = null;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            </div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;http_vars[<span class="stringliteral">&#39;service_body_id&#39;</span>])) {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                $service_body_array = explode(<span class="stringliteral">&quot;,&quot;</span>, $this-&gt;http_vars[<span class="stringliteral">&#39;service_body_id&#39;</span>]);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                <span class="keywordflow">foreach</span> ($service_body_array as $sb) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    $sb_int = intval($sb);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                    </div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    <span class="keywordflow">if</span> ($sb_int &gt; 0) {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                        $sb_obj = <a class="code" href="../../dd/d45/classc__comdef__server.html#aac85daa361f03562762940c543139cc5">c_comdef_server::GetServiceBodyByIDObj</a>($sb_int);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                        </div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                        <span class="keywordflow">if</span> ($sb_obj instanceof <a class="code" href="../../d1/dff/classc__comdef__service__body.html">c_comdef_service_body</a>) {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                            <span class="keywordflow">if</span> ($sb_obj-&gt;UserCanObserve()) {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                <span class="keywordflow">if</span> (!isset($service_body_id)) {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                    $service_body_id = $sb_int;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                } elseif (!is_array($service_body_id)) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                    $service_body_id = array ( $service_body_id, $sb_int );</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                    $service_body_id[] = $sb_int;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                            }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                        }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            </div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="comment">// We get the deleted meetings as CSV, then immediately turn them into XML.</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;get_deleted_meetings_as_csv($start_date, $end_date, <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>, $user_id, $service_body_id);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = $this-&gt;TranslateCSVToXML(<a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;meetings xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/GetDeletedMeetings.php\&quot;&gt;$ret&lt;/meetings&gt;&quot;</span>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        }</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        </div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">/*******************************************************************/</span><span class="comment"></span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">        \brief  This returns deleted meeting records in CSV form (which we turn into XML).</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">        \returns CSV data, with the first row a key header.</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#aa8e8e214244815461ad2b762968f3549">  491</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#aa8e8e214244815461ad2b762968f3549">get_deleted_meetings_as_csv</a>(</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        $in_start_date = null,  <span class="comment">///&lt; Optional. A start date (In PHP time() format). If supplied, then only deletions on, or after this date will be returned.</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"></span>        $in_end_date = null,    <span class="comment">///&lt; Optional. An end date (In PHP time() format). If supplied, then only deletions that occurred on, or before this date will be returned.</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"></span>        $in_meeting_id = null,  <span class="comment">///&lt; Optional. If supplied, an ID for a particular meeting. Only deletion for that meeting will be returned.</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"></span>        $in_user_id = null,     <span class="comment">///&lt; Optional. If supplied, an ID for a particular user. Only deletions made by that user will be returned.</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment"></span>        $in_sb_id = null        <span class="comment">///&lt; Optional. If supplied, an ID for a particular Service body. Only deletions for meetings in that Service body will be returned. If this is an array, then multiple Service bodies will be searched.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment"></span>    ) {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = null;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            $change_objects = <a class="code" href="../../dd/d45/classc__comdef__server.html#aebc5d4fd6276a2a70fbbe1f7950ab356">c_comdef_server::GetChangesFromIDAndType</a>(<span class="stringliteral">&#39;c_comdef_meeting&#39;</span>, null, $in_start_date, $in_end_date);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">if</span> ($change_objects instanceof <a class="code" href="../../d2/d5a/classc__comdef__changes.html">c_comdef_changes</a>) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                $obj_array = $change_objects-&gt;GetChangesObjects();</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            </div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <span class="keywordflow">if</span> (is_array($obj_array) &amp;&amp; count($obj_array)) {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    set_time_limit(max(30, intval(count($obj_array) / 20))); <span class="comment">// Change requests can take a loooong time...</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                    $localized_strings = <a class="code" href="../../dd/d45/classc__comdef__server.html#af8fe64ccd359a4877fc04cd52ac9b938">c_comdef_server::GetLocalStrings</a>();</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                    require_once(dirname(dirname(dirname(__FILE__))).<span class="stringliteral">&#39;/server/config/get-config.php&#39;</span>);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    <span class="comment">// These are our columns. This will be our header line.</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&quot;deletion_date_int&quot;,&quot;deletion_date_string&quot;,&quot;user_id&quot;,&quot;user_name&quot;,&quot;service_body_id&quot;,&quot;service_body_name&quot;,&quot;meeting_id&quot;,&quot;meeting_name&quot;,&quot;weekday_tinyint&quot;,&quot;weekday_name&quot;,&quot;start_time&quot;,&quot;location_city_subsection&quot;,&quot;location_municipality&quot;,&quot;location_province&quot;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                </div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                    <span class="comment">// If they specify a Service body, we also look in &quot;child&quot; Service bodies, so we need to produce a flat array of IDs.</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                    <span class="keywordflow">if</span> (isset($in_sb_id) &amp;&amp; $in_sb_id) {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                        <span class="comment">// If this is not an array, then we check for children. If it is an array, then we just do exactly what is in the array, regardless of children.</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                        <span class="keywordflow">if</span> (!is_array($in_sb_id) || !count($in_sb_id)) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                            global $bmlt_array_gather;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    </div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                            $bmlt_array_gather = array();</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                    </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                            <span class="comment">/************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">                            * This little internal function will simply fill    *</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">                            * the $bmlt_array_gather array with a linear set of *</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">                            * Service body IDs that can be used for a quick     *</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">                            * comparison, later on. It is a callback function.  *</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">                            ****************************************************/</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                            <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                            <span class="keyword">function</span> bmlt_at_at(</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                $in_value,</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                $in_key</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                            ) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                global $bmlt_array_gather;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                        </div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                <span class="keywordflow">if</span> ($in_value instanceof <a class="code" href="../../d1/dff/classc__comdef__service__body.html">c_comdef_service_body</a>) {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                    array_push($bmlt_array_gather, $in_value-&gt;GetID());</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                            }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        </div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                            $array_to_walk = <a class="code" href="../../dd/d45/classc__comdef__server.html#a73c17efb58fc8625e47b151164c67ad4">c_comdef_server::GetServer</a>()-&gt;GetNestedServiceBodyArray($in_sb_id);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                            array_walk_recursive($array_to_walk, <span class="stringliteral">&#39;bmlt_at_at&#39;</span>);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    </div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                            <span class="keywordflow">if</span> (is_array($bmlt_array_gather) &amp;&amp; count($bmlt_array_gather)) {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                $in_sb_id = $bmlt_array_gather;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                $in_sb_id = array ( $in_sb_id );</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                            }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                        }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                    </div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    $fetched_ids_array = array();</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    <span class="keywordflow">foreach</span> ($obj_array as $change) {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                        $date_int = intval($change-&gt;GetChangeDate());</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                        $date_string = date(<span class="stringliteral">&quot;Y-m-d H:m:s&quot;</span>, $date_int);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    </div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                        <span class="keywordflow">if</span> ($change instanceof <a class="code" href="../../d5/d79/classc__comdef__change.html">c_comdef_change</a>) {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                            $b_obj = $change-&gt;GetBeforeObject();</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                            </div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                            <span class="keywordflow">if</span> ($change-&gt;GetAfterObject()) {   <span class="comment">// We are only interested in deleted meetings. If After exists, it was not a deletion.</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                            }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a> = intval($change-&gt;GetBeforeObjectID());  <span class="comment">// By default, we get the meeting ID from the &quot;before&quot; object.</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                            $sb_b = intval(($b_obj instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>) ? $b_obj-&gt;GetServiceBodyID() : 0);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                            </div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                            $sb_obj = <a class="code" href="../../dd/d45/classc__comdef__server.html#aac85daa361f03562762940c543139cc5">c_comdef_server::GetServiceBodyByIDObj</a>($sb_b);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                            <span class="keywordflow">if</span> (($sb_obj instanceof <a class="code" href="../../d1/dff/classc__comdef__service__body.html">c_comdef_service_body</a>) &amp;&amp; $sb_obj-&gt;UserCanObserve()) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                                $sb_c = intval($change-&gt;GetServiceBodyID());</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                            </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                <span class="keywordflow">if</span> (in_array(<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>, $fetched_ids_array)) {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                </div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                <span class="comment">// If this meeting currently exists, then it doesn&#39;t qualify.</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="../../dd/d45/classc__comdef__server.html#a11a015e9f4fcf09893c17d8a3e6504b3">c_comdef_server::GetMeetingsByID</a>(array ( <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a> ))) {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                                </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                $fetched_ids_array[] = <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                            </div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                                <span class="comment">// If we are looking for a particular meeting, and this is it, or we don&#39;t care, then go ahead.</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                <span class="keywordflow">if</span> ((intval($in_meeting_id) &amp;&amp; intval($in_meeting_id) == intval(<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>)) || !intval($in_meeting_id)) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                                    $meeting_name = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                                    $user_name = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                                    $meeting_town = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                    $meeting_state = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                            </div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                    <span class="comment">// If we are looking for a particular Service body, and this is it, or we don&#39;t caer about the Service body, then go ahead.</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                    <span class="keywordflow">if</span> (!is_array($in_sb_id) || !count($in_sb_id) || in_array($sb_b, $in_sb_id) || in_array($sb_c, $in_sb_id)) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                                        $sb_id = (intval($sb_c) ? $sb_c : $sb_b);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                                </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                        $user_id = intval($change-&gt;GetUserID());</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                                </div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                        <span class="comment">// If the user was specified, we look for changes by that user only. Otherwise, we don&#39;t care.</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                        <span class="keywordflow">if</span> ((isset($in_user_id) &amp;&amp; $in_user_id &amp;&amp; ($in_user_id == $user_id)) || !isset($in_user_id) || !$in_user_id) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                            <span class="comment">// Get the user that created this change.</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                            $user = <a class="code" href="../../dd/d45/classc__comdef__server.html#ac3680235988649b237ff82be9541e3f3">c_comdef_server::GetUserByIDObj</a>($user_id);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                </div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                            <span class="keywordflow">if</span> ($user instanceof <a class="code" href="../../d4/de6/classc__comdef__user.html">c_comdef_user</a>) {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                                $user_name = $user-&gt;GetLocalName();</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                                $user_name = <span class="stringliteral">&#39;????&#39;</span>;    <span class="comment">// Otherwise, it&#39;s a mystery.</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                            }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                            <span class="comment">// Using str_replace, because preg_replace is pretty expensive. However, I don&#39;t think this buys us much.</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                                            <span class="keywordflow">if</span> ($b_obj instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>) {</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                                $meeting_name = str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $b_obj-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;meeting_name&#39;</span>))));</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                                $meeting_borough = str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $b_obj-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;location_city_subsection&#39;</span>))));</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                                $meeting_town = str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $b_obj-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;location_municipality&#39;</span>))));</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                                $meeting_state = str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $b_obj-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;location_province&#39;</span>))));</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                            }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                </div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                            $weekday_tinyint = intval($b_obj-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;weekday_tinyint&#39;</span>));</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                            $weekday_name = $localized_strings[<span class="stringliteral">&quot;comdef_server_admin_strings&quot;</span>][<span class="stringliteral">&quot;meeting_search_weekdays_names&quot;</span>][$weekday_tinyint];</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                </div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                            $start_time = $b_obj-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;start_time&#39;</span>);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                        </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                            $sb = <a class="code" href="../../dd/d45/classc__comdef__server.html#aac85daa361f03562762940c543139cc5">c_comdef_server::GetServiceBodyByIDObj</a>($sb_id);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                            <span class="keywordflow">if</span> ($sb instanceof <a class="code" href="../../d1/dff/classc__comdef__service__body.html">c_comdef_service_body</a>) {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                                $sb_name = $sb-&gt;GetLocalName();</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                                                $sb_name = <span class="stringliteral">&#39;????&#39;</span>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                            }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                    </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                            <span class="comment">// We create an array, which we&#39;ll implode after we&#39;re done. Easy way to create a CSV row.</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                                            $change_line = array();</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                                    </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                            <span class="comment">// Create each column for this row.</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                                            <span class="keywordflow">if</span> ($date_int) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                                                $change_line[<span class="stringliteral">&#39;deletion_date_int&#39;</span>] = $date_int;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                                $change_line[<span class="stringliteral">&#39;deletion_date_int&#39;</span>] = 0;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                            }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                </div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                            <span class="keywordflow">if</span> ($date_string) {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                                $change_line[<span class="stringliteral">&#39;deletion_date_string&#39;</span>] = $date_string;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                                $change_line[<span class="stringliteral">&#39;deletion_date_string&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                            }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                </div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                            <span class="keywordflow">if</span> ($user_id) {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                                $change_line[<span class="stringliteral">&#39;user_id&#39;</span>] = $user_id;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                                $change_line[<span class="stringliteral">&#39;user_id&#39;</span>] = 0;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                            }</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                </div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                            <span class="keywordflow">if</span> ($user_name) {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                                                $change_line[<span class="stringliteral">&#39;user_name&#39;</span>] = $user_name;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                                $change_line[<span class="stringliteral">&#39;user_name&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                            }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                </div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                            <span class="keywordflow">if</span> ($sb_id) {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                                $change_line[<span class="stringliteral">&#39;service_body_id&#39;</span>] = $sb_id;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                                $change_line[<span class="stringliteral">&#39;service_body_id&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                            }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                </div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                            <span class="keywordflow">if</span> ($sb_name) {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                                $change_line[<span class="stringliteral">&#39;service_body_name&#39;</span>] = $sb_name;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                                $change_line[<span class="stringliteral">&#39;service_body_name&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                            }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                </div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                            <span class="keywordflow">if</span> (<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                                $change_line[<span class="stringliteral">&#39;meeting_id&#39;</span>] = <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                                $change_line[<span class="stringliteral">&#39;meeting_id&#39;</span>] = 0;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                            }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                </div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                            <span class="keywordflow">if</span> ($meeting_name) {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                                $change_line[<span class="stringliteral">&#39;meeting_name&#39;</span>] = $meeting_name;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                                $change_line[<span class="stringliteral">&#39;meeting_name&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                            }</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                </div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                            <span class="keywordflow">if</span> ($weekday_tinyint) {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                                $change_line[<span class="stringliteral">&#39;weekday_tinyint&#39;</span>] = $weekday_tinyint;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                                $change_line[<span class="stringliteral">&#39;weekday_tinyint&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                            }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                </div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                            <span class="keywordflow">if</span> ($weekday_name) {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                                $change_line[<span class="stringliteral">&#39;weekday_name&#39;</span>] = $weekday_name;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                                $change_line[<span class="stringliteral">&#39;weekday_name&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                            }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                </div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                            <span class="keywordflow">if</span> ($start_time) {</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                                $change_line[<span class="stringliteral">&#39;start_time&#39;</span>] = $start_time;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                                $change_line[<span class="stringliteral">&#39;start_time&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                            }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                                </div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                                            <span class="keywordflow">if</span> ($meeting_borough) {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                                $change_line[<span class="stringliteral">&#39;location_city_subsection&#39;</span>] = $meeting_borough;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                                                $change_line[<span class="stringliteral">&#39;location_city_subsection&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                            }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                </div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                            <span class="keywordflow">if</span> ($meeting_town) {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                                $change_line[<span class="stringliteral">&#39;location_municipality&#39;</span>] = $meeting_town;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                                                $change_line[<span class="stringliteral">&#39;location_municipality&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                            }</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                </div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                            <span class="keywordflow">if</span> ($meeting_state) {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                                                $change_line[<span class="stringliteral">&#39;location_province&#39;</span>] = $meeting_state;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                                $change_line[<span class="stringliteral">&#39;location_province&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                            }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                </div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="charliteral">&#39;&quot;&#39;</span>.implode(<span class="stringliteral">&#39;&quot;,&quot;&#39;</span>, $change_line).<span class="charliteral">&#39;&quot;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                        }</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                                    }</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                            }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                        }</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    }</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        } <span class="keywordflow">catch</span> (Exception $e) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;ERROR&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        }</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            </div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">/*******************************************************************/</span><span class="comment"></span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">        \brief  This returns change records in CSV form (which we turn into XML).</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">        \returns CSV data, with the first row a key header.</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00737"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#afb31a84cb5e63ed4dac58c9271982164">  737</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#afb31a84cb5e63ed4dac58c9271982164">get_changes_as_csv</a>(</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        $in_start_date = null,  <span class="comment">///&lt; Optional. A start date (In PHP time() format). If supplied, then only changes on, or after this date will be returned.</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment"></span>        $in_end_date = null,    <span class="comment">///&lt; Optional. An end date (In PHP time() format). If supplied, then only changes that occurred on, or before this date will be returned.</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment"></span>        $in_meeting_id = null,  <span class="comment">///&lt; Optional. If supplied, an ID for a particular meeting. Only changes for that meeting will be returned.</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment"></span>        $in_user_id = null,     <span class="comment">///&lt; Optional. If supplied, an ID for a particular user. Only changes made by that user will be returned.</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment"></span>        $in_sb_id = null,       <span class="comment">///&lt; Optional. If supplied, an ID for a particular Service body. Only changes for that Service body will be returned.</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment"></span>        $in_change_type = <span class="stringliteral">&#39;c_comdef_meeting&#39;</span>    <span class="comment">///&lt; This is the change type. Default is meeting change (NOTE: This function needs work to handle other types, but I figured I&#39;d put in a hook for later).</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment"></span>    ) {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = null;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">try</span> {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="comment">// Start by getting every meeting change between the given dates.</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            $change_objects = <a class="code" href="../../dd/d45/classc__comdef__server.html#aebc5d4fd6276a2a70fbbe1f7950ab356">c_comdef_server::GetChangesFromIDAndType</a>($in_change_type, null, $in_start_date, $in_end_date);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="keywordflow">if</span> ($change_objects instanceof <a class="code" href="../../d2/d5a/classc__comdef__changes.html">c_comdef_changes</a>) {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                $obj_array = $change_objects-&gt;GetChangesObjects();</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            </div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                <span class="keywordflow">if</span> (is_array($obj_array) &amp;&amp; count($obj_array)) {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                    set_time_limit(max(30, intval(count($obj_array) / 20))); <span class="comment">// Change requests can take a loooong time...</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                    $localized_strings = <a class="code" href="../../dd/d45/classc__comdef__server.html#af8fe64ccd359a4877fc04cd52ac9b938">c_comdef_server::GetLocalStrings</a>();</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                    require_once(dirname(dirname(dirname(__FILE__))).<span class="stringliteral">&#39;/server/config/get-config.php&#39;</span>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                    <span class="comment">// These are our columns. This will be our header line.</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&quot;new_meeting&quot;,&quot;change_id&quot;,&quot;date_int&quot;,&quot;date_string&quot;,&quot;change_type&quot;,&quot;meeting_id&quot;,&quot;meeting_name&quot;,&quot;user_id&quot;,&quot;user_name&quot;,&quot;service_body_id&quot;,&quot;service_body_name&quot;,&quot;meeting_exists&quot;,&quot;details&quot;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                </div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    <span class="comment">// If they specify a Service body, we also look in &quot;child&quot; Service bodies, so we need to produce a flat array of IDs.</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                    <span class="keywordflow">if</span> (isset($in_sb_id) &amp;&amp; $in_sb_id) {</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                        <span class="comment">// If this is not an array, then we check for children. If it is an array, then we just do exactly what is in the array, regardless of children.</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                        <span class="keywordflow">if</span> (!is_array($in_sb_id) || !count($in_sb_id)) {</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                            global $bmlt_array_gather;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                    </div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                            $bmlt_array_gather = array();</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                    </div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                            <span class="comment">/************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">                            * This little internal function will simply fill    *</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">                            * the $bmlt_array_gather array with a linear set of *</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">                            * Service body IDs that can be used for a quick     *</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">                            * comparison, later on. It is a callback function.  *</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">                            ****************************************************/</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                            <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                            <span class="keyword">function</span> bmlt_at_at(</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                $in_value,</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                                $in_key</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                            ) {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                global $bmlt_array_gather;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                        </div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                                <span class="keywordflow">if</span> ($in_value instanceof <a class="code" href="../../d1/dff/classc__comdef__service__body.html">c_comdef_service_body</a>) {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                    array_push($bmlt_array_gather, $in_value-&gt;GetID());</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                            }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                        </div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                            $array_to_walk = <a class="code" href="../../dd/d45/classc__comdef__server.html#a73c17efb58fc8625e47b151164c67ad4">c_comdef_server::GetServer</a>()-&gt;GetNestedServiceBodyArray($in_sb_id);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                            array_walk_recursive($array_to_walk, <span class="stringliteral">&#39;bmlt_at_at&#39;</span>);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                    </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                            <span class="keywordflow">if</span> (is_array($bmlt_array_gather) &amp;&amp; count($bmlt_array_gather)) {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                $in_sb_id = $bmlt_array_gather;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                $in_sb_id = array ( $in_sb_id );</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                            }</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                        }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                    }</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                </div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                    <span class="keywordflow">foreach</span> ($obj_array as $change) {</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                        $change_type = $change-&gt;GetChangeType();</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                        $date_int = intval($change-&gt;GetChangeDate());</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                        $date_string = date(<span class="stringliteral">&quot;Y-m-d H:m:s&quot;</span>, $date_int);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    </div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                        <span class="keywordflow">if</span> ($change instanceof <a class="code" href="../../d5/d79/classc__comdef__change.html">c_comdef_change</a>) {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                            $b_obj = $change-&gt;GetBeforeObject();</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                            $a_obj = $change-&gt;GetAfterObject();</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a> = intval($change-&gt;GetBeforeObjectID());  <span class="comment">// By default, we get the meeting ID from the &quot;before&quot; object.</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                            $sb_a = intval(($a_obj instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>) ? $a_obj-&gt;GetServiceBodyID() : 0);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                            $sb_b = intval(($b_obj instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>) ? $b_obj-&gt;GetServiceBodyID() : 0);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                            $sb_c = intval($change-&gt;GetServiceBodyID());</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                        </div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                            <span class="comment">// If the meeting was newly created, then we get the ID from the &quot;after&quot; object.</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                            <span class="keywordflow">if</span> (!<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>) {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                                <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a> = intval($change-&gt;GetAfterObjectID());</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                            }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                        </div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                            <span class="comment">// If we are looking for a particular meeting, and this is it, or we don&#39;t care, then go ahead.</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                            <span class="keywordflow">if</span> ((intval($in_meeting_id) &amp;&amp; intval($in_meeting_id) == intval(<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>)) || !intval($in_meeting_id)) {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                                $meeting_name = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                                $user_name = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                            </div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                <span class="comment">// If we are looking for a particular Service body, and this is it, or we don&#39;t caer about the Service body, then go ahead.</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                                <span class="keywordflow">if</span> (!is_array($in_sb_id) || !count($in_sb_id) || in_array($sb_a, $in_sb_id) || in_array($sb_b, $in_sb_id) || in_array($sb_c, $in_sb_id)) {</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                                    $sb_id = (intval($sb_c) ? $sb_c : (intval($sb_b) ? $sb_b : $sb_a));</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                                </div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                                    $user_id = intval($change-&gt;GetUserID());</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                                </div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                                    <span class="comment">// If the user was specified, we look for changes by that user only. Otherwise, we don&#39;t care.</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                                    <span class="keywordflow">if</span> ((isset($in_user_id) &amp;&amp; $in_user_id &amp;&amp; ($in_user_id == $user_id)) || !isset($in_user_id) || !$in_user_id) {</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                                        <span class="comment">// Get the user that created this change.</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                                        $user = <a class="code" href="../../dd/d45/classc__comdef__server.html#ac3680235988649b237ff82be9541e3f3">c_comdef_server::GetUserByIDObj</a>($user_id);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                                </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                                        <span class="keywordflow">if</span> ($user instanceof <a class="code" href="../../d4/de6/classc__comdef__user.html">c_comdef_user</a>) {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                                            $user_name = $user-&gt;GetLocalName();</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                                            $user_name = <span class="stringliteral">&#39;????&#39;</span>;    <span class="comment">// Otherwise, it&#39;s a mystery.</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                                        }</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            </div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                                        <span class="comment">// Using str_replace, because preg_replace is pretty expensive. However, I don&#39;t think this buys us much.</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                        <span class="keywordflow">if</span> ($b_obj instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>) {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                                            $meeting_name = str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $b_obj-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;meeting_name&#39;</span>))));</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                        } elseif ($a_obj instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>) {</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                                            $meeting_name = str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $a_obj-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;meeting_name&#39;</span>))));</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                                        }</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                </div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                        $sb = <a class="code" href="../../dd/d45/classc__comdef__server.html#aac85daa361f03562762940c543139cc5">c_comdef_server::GetServiceBodyByIDObj</a>($sb_id);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                </div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                                        <span class="keywordflow">if</span> ($sb instanceof <a class="code" href="../../d1/dff/classc__comdef__service__body.html">c_comdef_service_body</a>) {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                                            $sb_name = $sb-&gt;GetLocalName();</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                                            $sb_name = <span class="stringliteral">&#39;????&#39;</span>;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                                        }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                                    </div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                                        <span class="comment">// We see if the meeting currently exists.</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                        $meeting_exists = 0;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                                </div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                                        <span class="keywordflow">if</span> (<a class="code" href="../../dd/d45/classc__comdef__server.html#a1ed8d51fee14cd90a6bd9915580317b1">c_comdef_server::GetOneMeeting</a>(<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>, <span class="keyword">true</span>)) {</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                                            $meeting_exists = 1;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                                        }</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                                    </div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                                        <span class="comment">// Get the details of the change.</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                                        $details = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                        $desc = $change-&gt;DetailedChangeDescription();</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                                </div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                                        <span class="keywordflow">if</span> ($desc &amp;&amp; isset($desc[<span class="stringliteral">&#39;details&#39;</span>]) &amp;&amp; is_array($desc[<span class="stringliteral">&#39;details&#39;</span>])) {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                                            <span class="comment">// We need to prevent double-quotes, as they are the string delimiters, so we replace them with single-quotes.</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                                            $details = htmlspecialchars_decode(str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, implode(<span class="stringliteral">&quot; &quot;</span>, $desc[<span class="stringliteral">&#39;details&#39;</span>])))), ENT_COMPAT);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                                        } elseif ($desc &amp;&amp; isset($desc[<span class="stringliteral">&#39;details&#39;</span>])) {</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                            <span class="comment">// We need to prevent double-quotes, as they are the string delimiters, so we replace them with single-quotes.</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                                            $details = htmlspecialchars_decode(str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $desc[<span class="stringliteral">&#39;details&#39;</span>]))), ENT_COMPAT);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                                            $details = htmlspecialchars_decode(str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $desc[<span class="stringliteral">&#39;overall&#39;</span>]))), ENT_COMPAT);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                                        }</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                                    </div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                                        <span class="comment">// We create an array, which we&#39;ll implode after we&#39;re done. Easy way to create a CSV row.</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                        $change_line = array();</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                                    </div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                                        <span class="comment">// Create each column for this row.</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                                        $change_line[<span class="stringliteral">&quot;new_meeting&quot;</span>] = ($b_obj instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>) ? 0 : 1;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                        </div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                                        $change_line[<span class="stringliteral">&#39;change_id&#39;</span>] = $change-&gt;GetID();</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                                </div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                                        <span class="keywordflow">if</span> ($date_int) {</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                                            $change_line[<span class="stringliteral">&#39;date_int&#39;</span>] = $date_int;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                                            $change_line[<span class="stringliteral">&#39;date_int&#39;</span>] = 0;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                        }</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                </div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                                        <span class="keywordflow">if</span> ($date_string) {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                                            $change_line[<span class="stringliteral">&#39;date_string&#39;</span>] = $date_string;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                                            $change_line[<span class="stringliteral">&#39;date_string&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                                        }</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                                </div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                                        <span class="keywordflow">if</span> ($change_type) {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                            $change_line[<span class="stringliteral">&#39;change_type&#39;</span>] = $change_type;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                                            $change_line[<span class="stringliteral">&#39;change_type&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                                        }</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                                </div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                                        <span class="keywordflow">if</span> (<a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>) {</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                                            $change_line[<span class="stringliteral">&#39;meeting_id&#39;</span>] = <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a>;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                            $change_line[<span class="stringliteral">&#39;meeting_id&#39;</span>] = 0;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                        }</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                </div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                        <span class="keywordflow">if</span> ($meeting_name) {</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                            $change_line[<span class="stringliteral">&#39;meeting_name&#39;</span>] = $meeting_name;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                            $change_line[<span class="stringliteral">&#39;meeting_name&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                        }</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                                </div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                        <span class="keywordflow">if</span> ($user_id) {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                            $change_line[<span class="stringliteral">&#39;user_id&#39;</span>] = $user_id;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                            $change_line[<span class="stringliteral">&#39;user_id&#39;</span>] = 0;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                                        }</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                                </div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                                        <span class="keywordflow">if</span> ($user_name) {</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                            $change_line[<span class="stringliteral">&#39;user_name&#39;</span>] = $user_name;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                            $change_line[<span class="stringliteral">&#39;user_name&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                        }</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                </div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                        <span class="keywordflow">if</span> ($sb_id) {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                            $change_line[<span class="stringliteral">&#39;service_body_id&#39;</span>] = $sb_id;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                            $change_line[<span class="stringliteral">&#39;service_body_id&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                        }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                                </div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                                        <span class="keywordflow">if</span> ($sb_name) {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                                            $change_line[<span class="stringliteral">&#39;service_body_name&#39;</span>] = $sb_name;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                                            $change_line[<span class="stringliteral">&#39;service_body_name&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                                        }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                </div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                        $change_line[<span class="stringliteral">&#39;meeting_exists&#39;</span>] = $meeting_exists;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                </div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                                        <span class="keywordflow">if</span> ($details) {</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                            $change_line[<span class="stringliteral">&#39;details&#39;</span>] = $details;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                            $change_line[<span class="stringliteral">&#39;details&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                        }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                                </div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="charliteral">&#39;&quot;&#39;</span>.implode(<span class="stringliteral">&#39;&quot;,&quot;&#39;</span>, $change_line).<span class="charliteral">&#39;&quot;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                    }</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                }</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                            }</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                        }</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            }</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        } <span class="keywordflow">catch</span> (Exception $e) {</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;ERROR&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    }</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    </div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">    \brief This fulfills a user request to get all the available fields for adding/modifying meeting data.</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">    \returns the XML for the template data.</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00965"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ac76cee2da14025c6bfcec00757629fbb">  965</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ac76cee2da14025c6bfcec00757629fbb">process_get_field_templates</a>()</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    {</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="comment">// First, make sure the use is of the correct general type.</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            <span class="comment">// Get the template data from the database.</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            $template_data = array_merge(<a class="code" href="../../d9/dcc/classc__comdef__meeting.html#a9c5e90b04a6aa747dcda54dc0c7b708b">c_comdef_meeting::GetMainDataTemplate</a>(), <a class="code" href="../../d9/dcc/classc__comdef__meeting.html#a9a652f869f5b68a517fbff83b81f9d24">c_comdef_meeting::GetDataTableTemplate</a>());</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            $template_longdata = <a class="code" href="../../d9/dcc/classc__comdef__meeting.html#a16359662661b48bab9729a15cd991ab5">c_comdef_meeting::GetLongDataTableTemplate</a>();</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            <span class="comment">// We merge the two tables (data and longdata).</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="keywordflow">if</span> (is_array($template_data) &amp;&amp; count($template_data) &amp;&amp; is_array($template_longdata) &amp;&amp; count($template_longdata)) {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                $template_data = array_merge($template_data, $template_longdata);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            }</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            </div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            <span class="comment">// $template_data now contains the templates for the meeting data. These are the available &quot;slots&quot; for new values. We need to convert to XML.</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            </div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="keywordflow">foreach</span> ($template_data as $template) {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;field_template&gt;&#39;</span>;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;key&gt;&#39;</span>.c_comdef_htmlspecialchars($template[<span class="stringliteral">&#39;key&#39;</span>]).<span class="stringliteral">&#39;&lt;/key&gt;&#39;</span>;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;field_prompt&gt;&#39;</span>.c_comdef_htmlspecialchars($template[<span class="stringliteral">&#39;field_prompt&#39;</span>]).<span class="stringliteral">&#39;&lt;/field_prompt&gt;&#39;</span>;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;lang_enum&gt;&#39;</span>.c_comdef_htmlspecialchars($template[<span class="stringliteral">&#39;lang_enum&#39;</span>]).<span class="stringliteral">&#39;&lt;/lang_enum&gt;&#39;</span>;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;visibility&gt;&#39;</span>.intval($template[<span class="stringliteral">&#39;visibility&#39;</span>]).<span class="stringliteral">&#39;&lt;/visibility&gt;&#39;</span>;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                    </div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                <span class="keywordflow">if</span> (isset($template[<span class="stringliteral">&#39;data_string&#39;</span>])) {</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;data_string&gt;&#39;</span>.c_comdef_htmlspecialchars($template[<span class="stringliteral">&#39;data_string&#39;</span>]).<span class="stringliteral">&#39;&lt;/data_string&gt;&#39;</span>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                }</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                        </div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                <span class="keywordflow">if</span> (isset($template[<span class="stringliteral">&#39;data_bigint&#39;</span>])) {</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;data_bigint&gt;&#39;</span>.intval($template[<span class="stringliteral">&#39;data_bigint&#39;</span>]).<span class="stringliteral">&#39;&lt;/data_bigint&gt;&#39;</span>;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                        </div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                <span class="keywordflow">if</span> (isset($template[<span class="stringliteral">&#39;data_double&#39;</span>])) {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;data_double&gt;&#39;</span>.intval($template[<span class="stringliteral">&#39;data_double&#39;</span>]).<span class="stringliteral">&#39;&lt;/data_double&gt;&#39;</span>;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                }</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                        </div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                <span class="keywordflow">if</span> (isset($template[<span class="stringliteral">&#39;data_longtext&#39;</span>])) {</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;data_longtext&gt;&#39;</span>.c_comdef_htmlspecialchars($template[<span class="stringliteral">&#39;data_longtext&#39;</span>]).<span class="stringliteral">&#39;&lt;/data_longtext&gt;&#39;</span>;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                }</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                        </div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                <span class="keywordflow">if</span> (isset($template[<span class="stringliteral">&#39;data_blob&#39;</span>])) {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;data_blob&gt;&#39;</span>.c_comdef_htmlspecialchars(base64_encode($template[<span class="stringliteral">&#39;data_blob&#39;</span>])).<span class="stringliteral">&#39;&lt;/data_blob&gt;&#39;</span>;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;/field_template&gt;&#39;</span>;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            }</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            </div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;field_templates xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/FieldTemplates.php\&quot;&gt;$ret&lt;/field_templates&gt;&quot;</span>;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        }</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            </div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    }</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    </div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">    \brief This fulfills a user request to delete an existing meeting. $this-&gt;http_vars[&#39;meeting_id&#39;] must be set to the meeting ID.</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">    \returns A very simple XML Report.</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01026"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a04e8695d7c50cc7aae7d443c729ebf25"> 1026</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a04e8695d7c50cc7aae7d443c729ebf25">process_meeting_delete</a>()</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = null;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        </div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="comment">// First, make sure the use is of the correct general type.</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            $meeting_obj = $this-&gt;server-&gt;GetOneMeeting(intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]));</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            <span class="keywordflow">if</span> ($meeting_obj instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>) { <span class="comment">// Make sure we got a meeting.</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                <span class="keywordflow">if</span> ($meeting_obj-&gt;UserCanEdit($this-&gt;server-&gt;GetCurrentUserObj())) {  <span class="comment">// Make sure that we are allowed to edit this meeting.</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                    <span class="comment">// Before we say goodbye, we take down the relevant details for the next of kin...</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                    $id = intval($meeting_obj-&gt;GetID());</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                    $service_body_id = intval($meeting_obj-&gt;GetServiceBodyID());</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                    $name = <a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>(str_replace(<span class="charliteral">&#39;&quot;&#39;</span>, <span class="stringliteral">&quot;&#39;&quot;</span>, str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&quot; &quot;</span>, $meeting_obj-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;meeting_name&#39;</span>)))));</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                    $weekday = intval($meeting_obj-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;weekday_tinyint&#39;</span>));</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                    $start_time = <a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($meeting_obj-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;start_time&#39;</span>));</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                    </div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                    $meeting_obj-&gt;DeleteFromDB();   <span class="comment">// Delete the meeting.</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                    </div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                    <span class="comment">// Write out the death certificate.</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;meetingId&gt;&#39;</span>.$id.<span class="stringliteral">&#39;&lt;/meetingId&gt;&lt;meeting_id&gt;&#39;</span>.$id.<span class="stringliteral">&#39;&lt;/meeting_id&gt;&lt;meetingName&gt;&#39;</span>.$name.<span class="stringliteral">&#39;&lt;/meetingName&gt;&lt;meetingServiceBodyId&gt;&#39;</span>.$service_body_id.<span class="stringliteral">&#39;&lt;/meetingServiceBodyId&gt;&lt;meetingStartTime&gt;&#39;</span>.$start_time.<span class="stringliteral">&#39;&lt;/meetingStartTime&gt;&lt;meetingWeekday&gt;&#39;</span>.$weekday.<span class="stringliteral">&#39;&lt;/meetingWeekday&gt;&#39;</span>;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;deletedMeeting xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/DeletedMeeting.php\&quot; id=\&quot;$id\&quot;&gt;$ret&lt;/deletedMeeting&gt;&quot;</span>;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;ERROR&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        }</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        </div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    }</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    </div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">    \brief This fulfills a user request to modify fields in a meeting (or create a new meeting).</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">           This requires that the following HTTP parameters be set:</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">                - meeting_id This is an integer that is the BMLT ID of the meeting being modified (the user must have edit rights to this meeting). If this is 0 (or unset), then we will be creating a new meeting.</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">                             If we are creating a new meeting, the new meeting will start at 8:30PM on Sunday, unless new values for the &#39;weekday&#39; and &#39;start_time&#39; fields are provided.</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">                             Once the meeting is created, we can set any of its fields as given.</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">                - meeting_field This is a string, or array of string, with the field name in the meeting search response.</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">                - new_value This is a string, or array of string, with the new value for the field. If the meeting_field parameter is an array, then each value here needs to be specified to correspond with the field.</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">    \returns XML, containing the fields modified.</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01073"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a9785a33c1af65821ce08728a72d1b287"> 1073</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a9785a33c1af65821ce08728a72d1b287">process_meeting_modify</a>()</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    {</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = null;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        </div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        $user_obj = $this-&gt;server-&gt;GetCurrentUserObj();</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="comment">// First, make sure the use is of the correct general type.</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            $closing_tag = <span class="stringliteral">&#39;&lt;/changeMeeting&gt;&#39;</span>; <span class="comment">// We will usually be changing existing meetings.</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            $my_editable_service_bodies = array();</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            $thisIsANewMeeting = <span class="keyword">false</span>; <span class="comment">// Set to true for new meetings.</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        </div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            $service_bodies = $this-&gt;server-&gt;GetServiceBodyArray();</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            </div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            <span class="keywordflow">if</span> ($user_obj-&gt;GetUserLevel() == <a class="code" href="../../df/d40/c__comdef__user_8class_8php.html#a813a0d07af6641590beaf373222f51a2">_USER_LEVEL_SERVICE_BODY_ADMIN</a>) {  <span class="comment">// Must be a Service Body Admin.</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                <span class="comment">// We cycle through all the Service bodies, and look for ones in which we have permissions.</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                <span class="comment">// We use the Service body IDs to key them in associative arrays.</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                <span class="keywordflow">foreach</span> ($service_bodies as $service_body) {</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                    <span class="keywordflow">if</span> ($service_body-&gt;UserCanEditMeetings()) { <span class="comment">// We are a full Service body editor, with rights to edit the Service body itself (as well as all its meetings).</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                        $my_editable_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()] = $service_body;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                    }</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                }</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            }</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            </div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            $new_meeting_id = 0;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            <span class="comment">// Get the meeting object, itself.</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            <span class="keywordflow">if</span> (!intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>])) {  <span class="comment">// Will we be creating a new meeting?</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                $service_bodies = $this-&gt;server-&gt;GetServiceBodyArray();</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                </div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                <span class="keywordflow">if</span> ($user_obj-&gt;GetUserLevel() == <a class="code" href="../../df/d40/c__comdef__user_8class_8php.html#a813a0d07af6641590beaf373222f51a2">_USER_LEVEL_SERVICE_BODY_ADMIN</a>) {  <span class="comment">// Must be a Service Body Admin.</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                    <span class="keywordflow">if</span> (isset($my_editable_service_bodies) &amp;&amp; is_array($my_editable_service_bodies) &amp;&amp; count($my_editable_service_bodies)) {</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                        $service_body_id = 0;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                    </div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                        <span class="comment">// If we are allowed to edit more than one Service body, then we are given a choice. We must supply an ID for the new meeting.</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                        <span class="keywordflow">if</span> (count($my_editable_service_bodies) &gt; 1) {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                            <span class="keywordflow">if</span> (isset($this-&gt;http_vars[<span class="stringliteral">&#39;service_body_id&#39;</span>]) &amp;&amp; intval($this-&gt;http_vars[<span class="stringliteral">&#39;service_body_id&#39;</span>])) {</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                                $service_body_id = intval($this-&gt;http_vars[<span class="stringliteral">&#39;service_body_id&#39;</span>]);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                                $meeting_fields = $this-&gt;http_vars[<span class="stringliteral">&#39;meeting_field&#39;</span>];</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                                </div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                                <span class="keywordflow">foreach</span> ($meeting_fields as $field) {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                                    list ( $key, $value ) = explode(<span class="charliteral">&#39;,&#39;</span>, $field);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                                    </div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                                    <span class="keywordflow">if</span> ($key == <span class="stringliteral">&#39;service_body_bigint&#39;</span>) {</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                                        $service_body_id = intval($value);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                                    }</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                                }</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                            }</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                        } <span class="keywordflow">else</span> <span class="comment">// Otherwise, it is picked for us.</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                            {</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                            <span class="comment">// We have to do this odd dance, because it&#39;s an associative array.</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                            $keys_1 = array_keys($my_editable_service_bodies);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                            </div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                            $service_body = $my_editable_service_bodies[$keys_1[0]];</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                            </div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                            <span class="keywordflow">if</span> ($service_body instanceof <a class="code" href="../../d1/dff/classc__comdef__service__body.html">c_comdef_service_body</a>) {</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                                $service_body_id = $service_body-&gt;GetID();</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                            }</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                        }</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                        </div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                        $weekday = 1;   <span class="comment">// Default is Sunday</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                        $start_time = <span class="stringliteral">&#39;20:30:00&#39;</span>; <span class="comment">// Default is 8:30 PM</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                        $lang = <a class="code" href="../../dd/d45/classc__comdef__server.html#a73c17efb58fc8625e47b151164c67ad4">c_comdef_server::GetServer</a>()-&gt;GetLocalLang();  <span class="comment">// We use whatever the server language is.</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                        <span class="keywordflow">if</span> ($service_body_id) { <span class="comment">// Can&#39;t create a new meeting without a Service body.</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                            $service_body = <a class="code" href="../../dd/d45/classc__comdef__server.html#a73c17efb58fc8625e47b151164c67ad4">c_comdef_server::GetServer</a>()-&gt;GetServiceBodyByIDObj($service_body_id);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                            <span class="keywordflow">if</span> ($service_body instanceof <a class="code" href="../../d1/dff/classc__comdef__service__body.html">c_comdef_service_body</a>) {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                <span class="keywordflow">if</span> ($service_body-&gt;UserCanEditMeetings($user_obj)) {</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                                    $new_meeting_id = <a class="code" href="../../dd/d45/classc__comdef__server.html#a6f7213b38b189bdfdf39248f1f64190a">c_comdef_server::AddNewMeeting</a>($service_body_id, $weekday, $start_time, $lang);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                                    $meeting_obj = $this-&gt;server-&gt;GetOneMeeting(intval($new_meeting_id));</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                                    $meeting_obj-&gt;SetPublished(<span class="keyword">false</span>);   <span class="comment">// New meetings are always unpublished.</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                                    <a class="code" href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a> = $new_meeting_id;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;newMeeting id=&quot;&#39;</span>.intval($meeting_obj-&gt;GetID()).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                                    $thisIsANewMeeting = <span class="keyword">true</span>;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                    $closing_tag = <span class="stringliteral">&#39;&lt;/newMeeting&gt;&#39;</span>;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                                }</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;ERROR&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                            }</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;ERROR&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                        }</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                    }</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                }</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                $meeting_obj = $this-&gt;server-&gt;GetOneMeeting(intval($this-&gt;http_vars[<span class="stringliteral">&#39;meeting_id&#39;</span>]));</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;changeMeeting id=&quot;&#39;</span>.intval($meeting_obj-&gt;GetID()).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            }</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            <span class="keywordflow">if</span> ($meeting_obj instanceof <a class="code" href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a>) {</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                <span class="keywordflow">if</span> ($meeting_obj-&gt;UserCanEdit($user_obj)) {    <span class="comment">// We next make sure that we are allowed to make changes to this meeting.</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                    $keys = <a class="code" href="../../d9/dcc/classc__comdef__meeting.html#a25371b1b5d4d3c016fe90ad6708deeb3">c_comdef_meeting::GetAllMeetingKeys</a>();  <span class="comment">// Get all the available keys. The one passed in needs to match one of these.</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                    $localized_strings = <a class="code" href="../../dd/d45/classc__comdef__server.html#af8fe64ccd359a4877fc04cd52ac9b938">c_comdef_server::GetLocalStrings</a>();</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                    <span class="comment">// In case we need to add a new field, we get the meeting data template.</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                    $template_data = <a class="code" href="../../d9/dcc/classc__comdef__meeting.html#a9a652f869f5b68a517fbff83b81f9d24">c_comdef_meeting::GetDataTableTemplate</a>();</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                    $template_longdata = <a class="code" href="../../d9/dcc/classc__comdef__meeting.html#a16359662661b48bab9729a15cd991ab5">c_comdef_meeting::GetLongDataTableTemplate</a>();</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    </div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                    <span class="comment">// We merge the two tables (data and longdata).</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                    <span class="keywordflow">if</span> (is_array($template_data) &amp;&amp; count($template_data) &amp;&amp; is_array($template_longdata) &amp;&amp; count($template_longdata)) {</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                        $template_data = array_merge($template_data, $template_longdata);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                    }</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            </div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    <span class="comment">// If so, we take the field, and tweak its value.</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                    $meeting_fields = $this-&gt;http_vars[<span class="stringliteral">&#39;meeting_field&#39;</span>];</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                </div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                    <span class="keywordflow">if</span> (!is_array($meeting_fields)) {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                        $meeting_fields = array ( $meeting_fields );</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                    </div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                    <span class="comment">// We change each of the fields passed in to the new values passed in.</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                    <span class="keywordflow">foreach</span> ($meeting_fields as $field) {</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                        list ( $meeting_field, $value ) = explode(<span class="charliteral">&#39;,&#39;</span>, $field, 2);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                        <span class="keywordflow">if</span> (strpos($value, <span class="stringliteral">&quot;##-##&quot;</span>)) {   <span class="comment">// Look for our special flagged items.</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                            $temp = explode(<span class="stringliteral">&quot;##-##&quot;</span>, $value);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                            $value = $temp[count($temp) - 1];</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                        }</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                        </div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                        <span class="keywordflow">if</span> (isset($meeting_field) &amp;&amp; in_array($meeting_field, $keys)) {</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                            <span class="keywordflow">switch</span> ($meeting_field) {</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;id_bigint&#39;</span>:   <span class="comment">// We don&#39;t currently let these get changed.</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;lang_enum&#39;</span>:</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                                    $value = null;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                                    $old_value = null;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                </div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;service_body_bigint&#39;</span>:</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                                    <span class="keywordflow">if</span> (isset($my_editable_service_bodies) &amp;&amp; is_array($my_editable_service_bodies) &amp;&amp; count($my_editable_service_bodies)) {</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                        $before_id = intval($meeting_obj-&gt;GetServiceBodyID());</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                        $after_id = intval($value);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                                        </div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                        <span class="comment">// Have to be allowed to edit both.</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                        <span class="keywordflow">if</span> ($my_editable_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$before_id] &amp;&amp; $my_editable_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$after_id]) {</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                            $old_value = $meeting_obj-&gt;GetServiceBodyID();</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                                            $meeting_obj-&gt;SetServiceBodyID(intval($value));</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                                        }</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                                    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                    }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                    </div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;email_contact&#39;</span>:</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                    $old_value = $meeting_obj-&gt;GetEmailContact();</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                    $meeting_obj-&gt;SetEmailContact(intval($value));</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                    </div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;published&#39;</span>:</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                                    <span class="keywordflow">if</span> (!$new_meeting_id) { <span class="comment">// New meetings are always unpublished.</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                        $old_value = $meeting_obj-&gt;IsPublished();</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                        $meeting_obj-&gt;SetPublished(intval($value) != 0 ? <span class="keyword">true</span> : <span class="keyword">false</span>);</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                                    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                                        $old_value = 0;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                                        $value = 0;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                                    }</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                    </div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;weekday_tinyint&#39;</span>:</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                                    <span class="keywordflow">if</span> ((intval($value) &gt; 0) &amp;&amp; (intval($value) &lt; 8)) {</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                                        $old_value = $meeting_obj-&gt;GetMeetingDataValue($meeting_field);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                                        $data =&amp; $meeting_obj-&gt;GetMeetingData();</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                                        $data[$meeting_field] = intval($value);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                                    }</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                    </div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;longitude&#39;</span>:</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;latitude&#39;</span>:</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                                    <span class="keywordflow">if</span> (floatval($value) != 0.0) {</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                                        $old_value = $meeting_obj-&gt;GetMeetingDataValue($meeting_field);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                                        $data =&amp; $meeting_obj-&gt;GetMeetingData();</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                                        $data[$meeting_field] = floatval($value);</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                                    }</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                    </div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;start_time&#39;</span>:</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;duration_time&#39;</span>:</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                                    $old_value = $meeting_obj-&gt;GetMeetingDataValue($meeting_field);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                                    $data =&amp; $meeting_obj-&gt;GetMeetingData();</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                                    $data[$meeting_field] = $value;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                    </div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;formats&#39;</span>:</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                                    <span class="comment">// Formats take some extra work, because we store them in the meeting as individual objects, so we create, sort and apply those objects.</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                                    $old_value_array = $meeting_obj-&gt;GetMeetingDataValue($meeting_field);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                                    $lang = $this-&gt;server-&gt;GetLocalLang();</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                                    $vals = array();</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                                    </div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                                    <span class="keywordflow">foreach</span> ($old_value_array as $format) {</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                                        <span class="keywordflow">if</span> ($format) {</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                                            $vals[$format-&gt;GetSharedID()] = $format;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                                        }</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                    }</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                                    </div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                                    uksort($vals, array ( <span class="stringliteral">&#39;c_comdef_meeting&#39;</span>,<span class="stringliteral">&#39;format_sorter_simple&#39;</span> ));</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                                    </div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                                    $keys_2 = array();</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                    <span class="keywordflow">foreach</span> ($vals as $format) {</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                        $keys_2[] = $format-&gt;GetKey();</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                                    }</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                        </div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                    $old_value = implode(<span class="stringliteral">&quot;,&quot;</span>, $keys_2);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                    </div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                    $formats = explode(<span class="stringliteral">&quot;,&quot;</span>, $value);</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                                    $formats_object = $this-&gt;server-&gt;GetFormatsObj();</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                                    </div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                    $newVals = array();</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                    <span class="keywordflow">foreach</span> ($formats as $key) {</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                        $object = $formats_object-&gt;GetFormatByKeyAndLanguage($key, $lang);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                                        <span class="keywordflow">if</span> ($object instanceof <a class="code" href="../../d9/db6/classc__comdef__format.html">c_comdef_format</a>) {</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                                            $newVals[$object-&gt;GetSharedID()] = $object;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                                        }</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                                    }</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                                        </div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                                    uksort($newVals, array ( <span class="stringliteral">&#39;c_comdef_meeting&#39;</span>,<span class="stringliteral">&#39;format_sorter_simple&#39;</span> ));</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                                    $data =&amp; $meeting_obj-&gt;GetMeetingData();</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                                    $data[$meeting_field] = $newVals;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                                </div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;worldid_mixed&#39;</span>:</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                    $old_value = $meeting_obj-&gt;GetMeetingDataValue($meeting_field);</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                                    $data =&amp; $meeting_obj-&gt;GetMeetingData();</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                                    $data[$meeting_field] = $value;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                    </div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;meeting_name&#39;</span>:</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                    $old_value = $meeting_obj-&gt;GetMeetingDataValue($meeting_field);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                                    <span class="keywordflow">if</span> (!isset($value) || !$value) {</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                        $value = $localized_strings[<span class="stringliteral">&quot;comdef_server_admin_strings&quot;</span>][<span class="stringliteral">&quot;Value_Prompts&quot;</span>][<span class="stringliteral">&quot;generic&quot;</span>];</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                    }</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                    <span class="comment">// Assuming fallthrough is intentional here, due to lack of break statement?</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                                    </div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                                <span class="keywordflow">default</span>:</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                                    $old_value = $meeting_obj-&gt;GetMeetingDataValue($meeting_field);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                                    $data =&amp; $meeting_obj-&gt;GetMeetingData();</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                                    $prompt = isset($data[$meeting_field][<span class="stringliteral">&#39;field_prompt&#39;</span>]) ? $data[$meeting_field][<span class="stringliteral">&#39;field_prompt&#39;</span>] : $template_data[$meeting_field][<span class="stringliteral">&#39;field_prompt&#39;</span>];</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                                    $visibility = intval(isset($data[$meeting_field][<span class="stringliteral">&#39;visibility&#39;</span>]) ? $data[$meeting_field][<span class="stringliteral">&#39;visibility&#39;</span>] : $template_data[$meeting_field][<span class="stringliteral">&#39;visibility&#39;</span>]);</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                                    $meeting_obj-&gt;AddDataField($meeting_field, $prompt, $value, null, $visibility, <span class="keyword">true</span>);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                            }</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                                </div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                            <span class="comment">// We only indicate changes.</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                            <span class="keywordflow">if</span> (isset($meeting_field) &amp;&amp; $meeting_field &amp;&amp; !($thisIsANewMeeting &amp;&amp; !(isset($value) &amp;&amp; $value)) &amp;&amp; ((isset($old_value) &amp;&amp; $old_value) || (isset($value) &amp;&amp; $value)) &amp;&amp; ($old_value != $value)) {</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                                $ret_temp = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                                $ret_temp_internal = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                                <span class="comment">// New meetings have no old data.</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                                <span class="keywordflow">if</span> (!$thisIsANewMeeting &amp;&amp; isset($old_value) &amp;&amp; $old_value) {</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                    $ret_temp_internal .= <span class="stringliteral">&#39;&lt;oldValue&gt;&#39;</span>.c_comdef_htmlspecialchars($old_value).<span class="stringliteral">&#39;&lt;/oldValue&gt;&#39;</span>;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                                }</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                                    </div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                                <span class="keywordflow">if</span> (isset($value) &amp;&amp; $value) {</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                                    $ret_temp_internal .= <span class="stringliteral">&#39;&lt;newValue&gt;&#39;</span>.c_comdef_htmlspecialchars($value).<span class="stringliteral">&#39;&lt;/newValue&gt;&#39;</span>;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                                }</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                            </div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                                $ret_temp .= <span class="stringliteral">&#39;&lt;field key=&quot;&#39;</span>.c_comdef_htmlspecialchars($meeting_field).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>.$ret_temp_internal.<span class="stringliteral">&#39;&lt;/field&gt;&#39;</span>;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                                </div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                                <span class="comment">// We only send back changes that were actually made. This reduces empty response data.</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                                <span class="keywordflow">if</span> ($ret_temp_internal) {</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= $ret_temp;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                }</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                            }</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                                </div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                                $meeting_field = null;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                        }</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                    }</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                        <span class="comment">// This can short-circuit the operation.</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> != <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>) {</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                        $meeting_obj-&gt;UpdateToDB(); <span class="comment">// Save the new data. After this, the meeting has been changed.</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                        </div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= $closing_tag;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                        </div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;changeResponse xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/ChangeResponse.php\&quot;&gt;$ret&lt;/changeResponse&gt;&quot;</span>;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                    }</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                }</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;ERROR&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            }</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        }</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            </div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    }</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    </div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">    \brief This fulfills a user request to return meeting information from a search.</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">    \returns XML, containing the answer.</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01373"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a22375075ad60d382a134c7f3e430f7c3"> 1373</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a22375075ad60d382a134c7f3e430f7c3">process_meeting_search</a>()</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    {</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <span class="keywordflow">if</span> (!( isset($this-&gt;http_vars[<span class="stringliteral">&#39;geo_width&#39;</span>]) &amp;&amp; $this-&gt;http_vars[<span class="stringliteral">&#39;geo_width&#39;</span>] ) &amp;&amp; isset($this-&gt;http_vars[<span class="stringliteral">&#39;bmlt_search_type&#39;</span>]) &amp;&amp; ($this-&gt;http_vars[<span class="stringliteral">&#39;bmlt_search_type&#39;</span>] == <span class="stringliteral">&#39;advanced&#39;</span>) &amp;&amp; isset($this-&gt;http_vars[<span class="stringliteral">&#39;advanced_radius&#39;</span>]) &amp;&amp; isset($this-&gt;http_vars[<span class="stringliteral">&#39;advanced_mapmode&#39;</span>]) &amp;&amp; $this-&gt;http_vars[<span class="stringliteral">&#39;advanced_mapmode&#39;</span>] &amp;&amp; ( floatval($this-&gt;http_vars[<span class="stringliteral">&#39;advanced_radius&#39;</span>] != 0.0) ) &amp;&amp; isset($this-&gt;http_vars[<span class="stringliteral">&#39;lat_val&#39;</span>]) &amp;&amp;   isset($this-&gt;http_vars[<span class="stringliteral">&#39;long_val&#39;</span>]) &amp;&amp; ( (floatval($this-&gt;http_vars[<span class="stringliteral">&#39;lat_val&#39;</span>]) != 0.0) || (floatval($this-&gt;http_vars[<span class="stringliteral">&#39;long_val&#39;</span>]) != 0.0) )) {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            $this-&gt;http_vars[<span class="stringliteral">&#39;geo_width&#39;</span>] = $this-&gt;http_vars[<span class="stringliteral">&#39;advanced_radius&#39;</span>];</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        } elseif (!( isset($this-&gt;http_vars[<span class="stringliteral">&#39;geo_width&#39;</span>]) &amp;&amp; $this-&gt;http_vars[<span class="stringliteral">&#39;geo_width&#39;</span>] ) &amp;&amp; isset($this-&gt;http_vars[<span class="stringliteral">&#39;bmlt_search_type&#39;</span>]) &amp;&amp; ($this-&gt;http_vars[<span class="stringliteral">&#39;bmlt_search_type&#39;</span>] == <span class="stringliteral">&#39;advanced&#39;</span>)) {</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            $this-&gt;http_vars[<span class="stringliteral">&#39;lat_val&#39;</span>] = null;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            $this-&gt;http_vars[<span class="stringliteral">&#39;long_val&#39;</span>] = null;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        } elseif (!isset($this-&gt;http_vars[<span class="stringliteral">&#39;geo_loc&#39;</span>]) || $this-&gt;http_vars[<span class="stringliteral">&#39;geo_loc&#39;</span>] != <span class="stringliteral">&#39;yes&#39;</span>) {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;http_vars[<span class="stringliteral">&#39;geo_width&#39;</span>])) {</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                $this-&gt;http_vars[<span class="stringliteral">&#39;geo_width&#39;</span>] = 0;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            }</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        }</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        require_once(dirname(dirname(dirname(__FILE__))).<span class="stringliteral">&#39;/client_interface/csv/search_results_csv.php&#39;</span>);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    </div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        $geocode_results = null;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        $ignore_me = null;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        $meeting_objects = array();</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        $formats_ar = array ();</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        $result2 = <a class="code" href="../../da/d34/search__results__csv_8php.html#a26e3d1e9f10048575aa522572279d6bd">DisplaySearchResultsCSV</a>($this-&gt;http_vars, $ignore_me, $geocode_results, $meeting_objects);</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keywordflow">if</span> (is_array($meeting_objects) &amp;&amp; count($meeting_objects) &amp;&amp; is_array($formats_ar)) {</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            <span class="keywordflow">foreach</span> ($meeting_objects as $one_meeting) {</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                $formats = $one_meeting-&gt;GetMeetingDataValue(<span class="stringliteral">&#39;formats&#39;</span>);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                <span class="keywordflow">foreach</span> ($formats as $format) {</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                    <span class="keywordflow">if</span> ($format &amp;&amp; ($format instanceof <a class="code" href="../../d9/db6/classc__comdef__format.html">c_comdef_format</a>)) {</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                        $format_shared_id = $format-&gt;GetSharedID();</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                        $formats_ar[$format_shared_id] = $format;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                    }</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                }</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            }</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        }</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    </div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;http_vars[<span class="stringliteral">&#39;data_field_key&#39;</span>]) &amp;&amp; $this-&gt;http_vars[<span class="stringliteral">&#39;data_field_key&#39;</span>]) {</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            <span class="comment">// At this point, we have everything in a CSV. We separate out just the field we want.</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            $temp_keyed_array = array();</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            $result = explode(<span class="stringliteral">&quot;\n&quot;</span>, $result);</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            $keys = array_shift($result);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            $keys = explode(<span class="stringliteral">&quot;\&quot;,\&quot;&quot;</span>, trim($keys, <span class="charliteral">&#39;&quot;&#39;</span>));</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            $the_keys = explode(<span class="charliteral">&#39;,&#39;</span>, $this-&gt;http_vars[<span class="stringliteral">&#39;data_field_key&#39;</span>]);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        </div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            $result = array();</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            <span class="keywordflow">foreach</span> ($result2 as $row) {</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                <span class="keywordflow">if</span> ($row) {</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                    $index = 0;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                    $row = explode(<span class="stringliteral">&#39;&quot;,&quot;&#39;</span>, trim($row, <span class="stringliteral">&#39;&quot;,&#39;</span>));</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                    $row_columns = array();</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                    <span class="keywordflow">foreach</span> ($row as $column) {</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                        <span class="keywordflow">if</span> (!$column) {</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                            $column = <span class="charliteral">&#39; &#39;</span>;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                        }</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                        <span class="keywordflow">if</span> (in_array($keys[$index++], $the_keys)) {</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                            array_push($row_columns, $column);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                        }</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                    }</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                    $result[$row[0]] = <span class="charliteral">&#39;&quot;&#39;</span>.implode(<span class="stringliteral">&#39;&quot;,&quot;&#39;</span>, $row_columns).<span class="charliteral">&#39;&quot;&#39;</span>;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                }</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            }</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            $the_keys = array_intersect($keys, $the_keys);</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            $result2 = <span class="charliteral">&#39;&quot;&#39;</span>.implode(<span class="stringliteral">&#39;&quot;,&quot;&#39;</span>, $the_keys).<span class="stringliteral">&quot;\&quot;\n&quot;</span>.implode(<span class="stringliteral">&quot;\n&quot;</span>, $result);</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        }</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        </div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        </div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        $result = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;meetings xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/GetSearchResults.php\&quot;&gt;&quot;</span>;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        $result .= $this-&gt;TranslateCSVToXML($result2);</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        <span class="keywordflow">if</span> ((isset(<a class="code" href="../../dd/da0/local__server_2index_8php.html#a634e4fb3f0535a99050530167407ff87">$http_vars</a>[<span class="stringliteral">&#39;get_used_formats&#39;</span>]) || isset(<a class="code" href="../../dd/da0/local__server_2index_8php.html#a634e4fb3f0535a99050530167407ff87">$http_vars</a>[<span class="stringliteral">&#39;get_formats_only&#39;</span>])) &amp;&amp; $formats_ar &amp;&amp; is_array($formats_ar) &amp;&amp; count($formats_ar)) {</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            <span class="keywordflow">if</span> (isset(<a class="code" href="../../dd/da0/local__server_2index_8php.html#a634e4fb3f0535a99050530167407ff87">$http_vars</a>[<span class="stringliteral">&#39;get_formats_only&#39;</span>])) {</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                $result = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;formats xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/GetFormats.php\&quot;&gt;&quot;</span>;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                $result .= <span class="stringliteral">&quot;&lt;formats&gt;&quot;</span>;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            }</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            $result3 = <a class="code" href="../../d6/d23/csv_8php.html#afdce10070c62f12d732cf7c40e548a09">GetFormats</a>(<a class="code" href="../../d4/dae/config-bmlt-basic_8inc_8php.html#ad135cc8a47e55f0829949cf62214170f">$server</a>, $langs, $formats_ar);</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            $result .= <a class="code" href="../../d6/d23/csv_8php.html#a10fdc8c4ebeef06534a9ebaf849c94ab">TranslateToXML</a>($result3);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        </div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            $result .= <span class="stringliteral">&quot;&lt;/formats&gt;&quot;</span>;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        }</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    </div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        $result .= isset(<a class="code" href="../../dd/da0/local__server_2index_8php.html#a634e4fb3f0535a99050530167407ff87">$http_vars</a>[<span class="stringliteral">&#39;get_formats_only&#39;</span>]) ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;&lt;/meetings&gt;&quot;</span>;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    </div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        <span class="keywordflow">return</span> $result;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    }</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    </div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">    \brief This fulfills a user request to return format information.</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment">    \returns XML, containing the answer.</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01464"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#abd668b301f7aa040d76226d633e3d0d0"> 1464</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#abd668b301f7aa040d76226d633e3d0d0">process_format_info</a>()</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    {</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        </div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            $format_ids = array();</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            </div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            <span class="comment">// See if we are receiving a request for just specific formats, or if we are being asked for all of them.</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;http_vars[<span class="stringliteral">&#39;format_id&#39;</span>]) &amp;&amp; intval(trim($this-&gt;http_vars[<span class="stringliteral">&#39;format_id&#39;</span>]))) {</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                $format_ids[] = intval(trim($this-&gt;http_vars[<span class="stringliteral">&#39;format_id&#39;</span>]));</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            } elseif (isset($this-&gt;http_vars[<span class="stringliteral">&#39;format_id&#39;</span>]) &amp;&amp; is_array($this-&gt;http_vars[<span class="stringliteral">&#39;format_id&#39;</span>]) &amp;&amp; count($this-&gt;http_vars[<span class="stringliteral">&#39;format_id&#39;</span>])) {</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;http_vars[<span class="stringliteral">&#39;format_id&#39;</span>] as $format) {</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                    $format_ids[] = intval(trim($format));</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                }</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                $format_ids = null;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            }</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            </div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            $lang = $this-&gt;server-&gt;GetLocalLang();</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;http_vars[<span class="stringliteral">&#39;lang&#39;</span>]) &amp;&amp; trim($this-&gt;http_vars[<span class="stringliteral">&#39;lang&#39;</span>])) {</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                $lang = strtolower(trim($this-&gt;http_vars[<span class="stringliteral">&#39;lang&#39;</span>]));</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            }</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            </div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            $returned_formats = array();    <span class="comment">// We will be returning our formats in this.</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            $format_objects = $this-&gt;server-&gt;GetFormatsObj()-&gt;GetFormatsByLanguage($lang); <span class="comment">// Get all the formats (not just the ones used, but ALL of them).</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            </div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            <span class="comment">// Filter for requested formats in the requested language.</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            <span class="keywordflow">foreach</span> ($format_objects as $format) {</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                <span class="keywordflow">if</span> (!$format_ids || in_array(intval($format-&gt;GetSharedID()), $format_ids)) {</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                    $returned_formats[] = $format;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                }</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            }</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            </div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;            <span class="comment">// At this point, we have a complete array of just the format[s] that will be returned. Time to make some XML...</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;            $index = 0;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            </div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;            <span class="comment">// We will find out which formats actually appear, somewhere in the DB, and indicate that when we give the info.</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            $used_formats = $this-&gt;server-&gt;GetUsedFormatsArray();</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            $used_ids = array();</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            </div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            <span class="keywordflow">foreach</span> ($used_formats as $format) {</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                $used_ids[] = intval($format-&gt;GetSharedID());</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;            }</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;            </div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;            <span class="keywordflow">foreach</span> ($returned_formats as $format) {</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;row sequence_index=&quot;&#39;</span>.strval($index++).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                    $id = intval($format-&gt;GetSharedID());</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>.= <span class="stringliteral">&#39;&lt;key_string&gt;&#39;</span>.c_comdef_htmlspecialchars($format-&gt;GetKey()).<span class="stringliteral">&#39;&lt;/key_string&gt;&#39;</span>;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>.= <span class="stringliteral">&#39;&lt;name_string&gt;&#39;</span>.c_comdef_htmlspecialchars($format-&gt;GetLocalName()).<span class="stringliteral">&#39;&lt;/name_string&gt;&#39;</span>;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>.= <span class="stringliteral">&#39;&lt;description_string&gt;&#39;</span>.c_comdef_htmlspecialchars($format-&gt;GetLocalDescription()).<span class="stringliteral">&#39;&lt;/description_string&gt;&#39;</span>;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>.= <span class="stringliteral">&#39;&lt;lang&gt;&#39;</span>.c_comdef_htmlspecialchars($lang).<span class="stringliteral">&#39;&lt;/lang&gt;&#39;</span>;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>.= <span class="stringliteral">&#39;&lt;id&gt;&#39;</span>.$id.<span class="stringliteral">&#39;&lt;/id&gt;&#39;</span>;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                    $world_id = trim($format-&gt;GetWorldID());</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                <span class="keywordflow">if</span> (isset($world_id) &amp;&amp; $world_id) {</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>.= <span class="stringliteral">&#39;&lt;world_id&gt;&#39;</span>.c_comdef_htmlspecialchars($world_id).<span class="stringliteral">&#39;&lt;/world_id&gt;&#39;</span>;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                }</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                    </div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                    <span class="comment">// If this is used somewehere, we indicate it here.</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                <span class="keywordflow">if</span> (in_array($id, $used_ids)) {</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>.= <span class="stringliteral">&#39;&lt;format_used_in_database&gt;1&lt;/format_used_in_database&gt;&#39;</span>;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                }</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                        </div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;/row&gt;&#39;</span>;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            }</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;formats xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/GetFormats.php\&quot;&gt;$ret&lt;/formats&gt;&quot;</span>;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        }</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            </div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    }</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    </div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">    \brief This fulfills a user request to return Service Body information for multiple Service bodies.</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment">    \returns XML, containing the answer.</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01543"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a016a5679ddad0ba55828e4dd3cb533d3"> 1543</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a016a5679ddad0ba55828e4dd3cb533d3">process_service_bodies_info_request</a>()</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    {</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        </div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            $service_body_ids = array();</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            </div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            <span class="comment">// Look to see if the caller is asking for particular Service bodies.</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;http_vars[<span class="stringliteral">&#39;sb_id&#39;</span>]) &amp;&amp; $this-&gt;http_vars[<span class="stringliteral">&#39;sb_id&#39;</span>]) {</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                <span class="keywordflow">if</span> (!is_array($this-&gt;http_vars[<span class="stringliteral">&#39;sb_id&#39;</span>])) {</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                    $service_body_ids[] = intval(trim($this-&gt;http_vars[<span class="stringliteral">&#39;sb_id&#39;</span>]));</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                    <span class="keywordflow">foreach</span> ($this-&gt;http_vars[<span class="stringliteral">&#39;sb_id&#39;</span>] as $id) {</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                        <span class="keywordflow">if</span> (intval(trim($id))) {</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                            $service_body_ids[] = intval(trim($id));</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                        }</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                    }</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                }</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;            }</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;            </div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;            <span class="comment">// If we have a request for individual Service bodies, then we just return those ones.</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            <span class="keywordflow">if</span> (isset($service_body_ids) &amp;&amp; is_array($service_body_ids) &amp;&amp; count($service_body_ids)) {</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                <span class="keywordflow">foreach</span> ($service_body_ids as $id) {</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= $this-&gt;process_service_body_info_request($id);</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                }</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;            } <span class="keywordflow">else</span> <span class="comment">// If they are not looking for particular bodies, then we return the whole kit &amp; kaboodle.</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                {</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                $service_bodies = $this-&gt;server-&gt;GetServiceBodyArray();</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            </div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                <span class="keywordflow">foreach</span> ($service_bodies as $service_body) {</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                    <span class="keywordflow">if</span> (isset($this-&gt;http_vars[<span class="stringliteral">&#39;flat&#39;</span>]) || !$service_body-&gt;GetOwnerIDObject()) {    <span class="comment">// We automatically include top-level Service bodies here, and let ones with parents sort themselves out.</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= $this-&gt;process_service_body_info_request($service_body-&gt;GetID());</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                    }</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                }</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            }</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        </div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;service_bodies xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/HierServiceBodies.php\&quot;&gt;$ret&lt;/service_bodies&gt;&quot;</span>;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        }</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            </div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    }</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    </div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">    \brief This fulfills a user request to return Service Body information.</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment">    \returns XML, containing the answer.</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01594"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a6a4573ed1ae18f06dcedcd952d2bf217"> 1594</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a6a4573ed1ae18f06dcedcd952d2bf217">process_service_body_info_request</a>(    $in_service_body_id <span class="comment">///&lt; The ID of the Service body being requested.</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment"></span>                                                )</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    {</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        <span class="comment">// Belt and suspenders. We need to make sure the user is authorized.</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            <span class="keywordflow">if</span> (!in_array($in_service_body_id, $this-&gt;handled_service_body_ids)) {</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                $this-&gt;handled_service_body_ids[] = $in_service_body_id;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                $service_body = $this-&gt;server-&gt;GetServiceBodyByIDObj($in_service_body_id);</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;            </div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                <span class="keywordflow">if</span> (isset($service_body) &amp;&amp; ($service_body instanceof <a class="code" href="../../d1/dff/classc__comdef__service__body.html">c_comdef_service_body</a>)) {</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                    <span class="comment">// Everyone gets the type, URI, name, description and parent Service body.</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                    $name = $service_body-&gt;GetLocalName();</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                    $description = $service_body-&gt;GetLocalDescription();</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                    $uri = $service_body-&gt;GetURI();</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                    $helpline = $service_body-&gt;GetHelpline();</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                    $type = $service_body-&gt;GetSBType();</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                    $parent_service_body_id = 0;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                    $parent_service_body_name = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                    $parent_service_body_type = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                    $parent_service_body = $service_body-&gt;GetOwnerIDObject();</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                </div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                    <span class="keywordflow">if</span> (isset($parent_service_body) &amp;&amp; $parent_service_body) {</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                        $parent_service_body_id = intval($parent_service_body-&gt;GetID());</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                        $parent_service_body_name = $parent_service_body-&gt;GetLocalName();</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                        $parent_service_body_type = $parent_service_body-&gt;GetSBType();</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                    }</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                </div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                    $principal_user = $service_body-&gt;GetPrincipalUserObj();</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                    $principal_user_id = intval($principal_user-&gt;GetID());</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                </div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                    <span class="comment">// Scan for our various editors.</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                    $guest_editors = $this-&gt;server-&gt;GetUsersByLevelObj(<a class="code" href="../../df/d40/c__comdef__user_8class_8php.html#ac761e512fea213a1db42c4023c3f9f83">_USER_LEVEL_OBSERVER</a>, <span class="keyword">true</span>);  <span class="comment">// Observer or greater.</span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                    $service_body_editors = array();</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                    $meeting_list_editors = array();</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                    $observers = array();</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                </div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                    <span class="keywordflow">foreach</span> ($guest_editors as $editor) {</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                        <span class="keywordflow">if</span> ($service_body-&gt;UserCanEdit($editor)) {   <span class="comment">// We will have at least one of these, as the principal user needs to be listed.</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                            array_push($service_body_editors, $editor);</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                        } elseif ($service_body-&gt;UserCanEditMeetings($editor)) {</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                            array_push($meeting_list_editors, $editor);</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                        } elseif ($service_body-&gt;UserCanObserve($editor)) {</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                            array_push($observers, $editor);</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                        }</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                    }</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                </div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                    <span class="comment">// Scan for direct descendant child Service bodies.</span></div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                    $children = array();</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                    $service_bodies = $this-&gt;server-&gt;GetServiceBodyArray();</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                </div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                    <span class="keywordflow">foreach</span> ($service_bodies as $child) {</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                        <span class="keywordflow">if</span> ($child-&gt;IsOwnedBy($in_service_body_id, <span class="keyword">true</span>)) {</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                            $children[] = $child;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                        }</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                    }</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                </div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                    <span class="comment">// We check to see which editors are mentioned in this Service body.</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                    $guest_editors = $service_body-&gt;GetEditors();</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                </div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                    <span class="comment">// See if we have rights to edit this Service body. Just for the heck of it, we check the user level (not really necessary, but belt and suspenders).</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                    $this_user_can_edit_the_body = ($this-&gt;server-&gt;GetCurrentUserObj()-&gt;GetUserLevel() == <a class="code" href="../../df/d40/c__comdef__user_8class_8php.html#a813a0d07af6641590beaf373222f51a2">_USER_LEVEL_SERVICE_BODY_ADMIN</a>) &amp;&amp; $service_body-&gt;UserCanEdit();</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                </div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                    $contact_email = null;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                </div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                    <span class="comment">// Service Body Admins (with permission for the body) get more info.</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                    <span class="keywordflow">if</span> ($this_user_can_edit_the_body) {</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                        $contact_email = $service_body-&gt;GetContactEmail();</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                    }</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                    </div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                    <span class="comment">// At this point, we have all the information we need to build the response XML.</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;service_body id=&quot;&#39;</span>.c_comdef_htmlspecialchars($in_service_body_id).<span class="stringliteral">&#39;&quot; name=&quot;&#39;</span>.<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($name).<span class="stringliteral">&#39;&quot; type=&quot;&#39;</span>.<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($type).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;service_body_type&gt;&#39;</span>.c_comdef_htmlspecialchars($this-&gt;my_localized_strings[<span class="stringliteral">&#39;service_body_types&#39;</span>][$type]).<span class="stringliteral">&#39;&lt;/service_body_type&gt;&#39;</span>;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                    <span class="keywordflow">if</span> (isset($description) &amp;&amp; $description) {</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;description&gt;&#39;</span>.c_comdef_htmlspecialchars($description).<span class="stringliteral">&#39;&lt;/description&gt;&#39;</span>;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                    }</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                    <span class="keywordflow">if</span> (isset($uri) &amp;&amp; $uri) {</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;uri&gt;&#39;</span>.c_comdef_htmlspecialchars($uri).<span class="stringliteral">&#39;&lt;/uri&gt;&#39;</span>;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                    }</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                    <span class="keywordflow">if</span> (isset($helpline) &amp;&amp; $helpline) {</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;helpline&gt;&#39;</span>.c_comdef_htmlspecialchars($helpline).<span class="stringliteral">&#39;&lt;/helpline&gt;&#39;</span>;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                    }</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                    <span class="keywordflow">if</span> (isset($parent_service_body) &amp;&amp; $parent_service_body) {</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;parent_service_body id=&quot;&#39;</span>.intval($parent_service_body_id).<span class="stringliteral">&#39;&quot; type=&quot;&#39;</span>.<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($parent_service_body_type).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>.<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($parent_service_body_name).<span class="stringliteral">&#39;&lt;/parent_service_body&gt;&#39;</span>;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                    }</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                    <span class="keywordflow">if</span> ($this_user_can_edit_the_body &amp;&amp; isset($contact_email) &amp;&amp; $contact_email) {</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;contact_email&gt;&#39;</span>.c_comdef_htmlspecialchars($contact_email).<span class="stringliteral">&#39;&lt;/contact_email&gt;&#39;</span>;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                    }</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                    </div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;editors&gt;&#39;</span>;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                    <span class="keywordflow">if</span> (isset($service_body_editors) &amp;&amp; is_array($service_body_editors) &amp;&amp; count($service_body_editors)) {</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                        <span class="comment">// We will have at least one of these (the principal user).</span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                        <span class="comment">// These are the users that can directly manipulate the Service body.</span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;service_body_editors&gt;&#39;</span>;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                        <span class="keywordflow">foreach</span> ($service_body_editors as $editor) {</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                                $editor_id = intval($editor-&gt;GetID());</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;editor id=&quot;&#39;</span>.$editor_id.<span class="stringliteral">&#39;&quot; admin_type=&quot;&#39;</span>.( in_array($editor_id, $guest_editors) ? <span class="stringliteral">&#39;direct&#39;</span> : (( $editor_id == $principal_user_id ) ? <span class="stringliteral">&#39;principal&#39;</span> : <span class="stringliteral">&#39;inherit&#39;</span>)).<span class="stringliteral">&#39;&quot; admin_name=&quot;&#39;</span>.<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($editor-&gt;GetLocalName()).<span class="stringliteral">&#39;&quot;/&gt;&#39;</span>;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                        }</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;/service_body_editors&gt;&#39;</span>;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                    }</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                        </div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                            <span class="comment">// These are users that can&#39;t manipulate the Service body, but can edit meetings.</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                    <span class="keywordflow">if</span> (isset($meeting_list_editors) &amp;&amp; is_array($meeting_list_editors) &amp;&amp; count($meeting_list_editors)) {</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;meeting_list_editors&gt;&#39;</span>;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                        <span class="keywordflow">foreach</span> ($meeting_list_editors as $editor) {</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                                $editor_id = intval($editor-&gt;GetID());</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;editor id=&quot;&#39;</span>.$editor_id.<span class="stringliteral">&#39;&quot; admin_type=&quot;&#39;</span>.( in_array($editor_id, $guest_editors) ? <span class="stringliteral">&#39;direct&#39;</span> : (( $editor_id == $principal_user_id ) ? <span class="stringliteral">&#39;principal&#39;</span> : <span class="stringliteral">&#39;inherit&#39;</span> )).<span class="stringliteral">&#39;&quot; admin_name=&quot;&#39;</span>.<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($editor-&gt;GetLocalName()).<span class="stringliteral">&#39;&quot;/&gt;&#39;</span>;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                        }</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;/meeting_list_editors&gt;&#39;</span>;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                    }</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                        </div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                            <span class="comment">// These are users that can only see hidden fields in meetings.</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                    <span class="keywordflow">if</span> (isset($observers) &amp;&amp; is_array($observers) &amp;&amp; count($observers)) {</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;observers&gt;&#39;</span>;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                        <span class="keywordflow">foreach</span> ($observers as $editor) {</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                                $editor_id = intval($editor-&gt;GetID());</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;editor id=&quot;&#39;</span>.$editor_id.<span class="stringliteral">&#39;&quot; admin_type=&quot;&#39;</span>.( in_array($editor_id, $guest_editors) ? <span class="stringliteral">&#39;direct&#39;</span> : (( $editor_id == $principal_user_id ) ? <span class="stringliteral">&#39;principal&#39;</span> : <span class="stringliteral">&#39;inherit&#39;</span> )).<span class="stringliteral">&#39;&quot; admin_name=&quot;&#39;</span>.<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($editor-&gt;GetLocalName()).<span class="stringliteral">&#39;&quot;/&gt;&#39;</span>;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                        }</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                                <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;/observers&gt;&#39;</span>;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                    }</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;/editors&gt;&#39;</span>;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                </div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                        <span class="comment">// If this is a hierarchical response, we embed the children as XML service_body elements. Otherwise, we list them as simple catalog elements.</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                    <span class="keywordflow">if</span> (!isset($this-&gt;http_vars[<span class="stringliteral">&#39;flat&#39;</span>]) &amp;&amp; isset($children) &amp;&amp; is_array($children) &amp;&amp; count($children)) {</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&quot;&lt;service_bodies&gt;&quot;</span>;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                        <span class="keywordflow">foreach</span> ($children as $child) {</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= $this-&gt;process_service_body_info_request($child-&gt;GetID());</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                        }</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&quot;&lt;/service_bodies&gt;&quot;</span>;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                    } elseif (isset($children) &amp;&amp; is_array($children) &amp;&amp; count($children)) {</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;children&gt;&#39;</span>;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                        <span class="keywordflow">foreach</span> ($children as $child) {</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;child_service_body id=&quot;&#39;</span>.intval($child-&gt;GetID()).<span class="stringliteral">&#39;&quot; type=&quot;&#39;</span>.<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($child-&gt;GetSBType()).<span class="stringliteral">&#39;&quot;&gt;&#39;</span>.<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($child-&gt;GetLocalName()).<span class="stringliteral">&#39;&lt;/child_service_body&gt;&#39;</span>;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                        }</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;/children&gt;&#39;</span>;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                    }</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;/service_body&gt;&#39;</span>;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                }</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            }</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        }</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            </div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    }</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    </div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment">    \brief This fulfills a user request to report the rights for the logged-in user.</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">    \returns XML, containing the answer.</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">    ************************************************************************************************************/</span></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01750"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a57189f7539b74008e2f267874203ec14"> 1750</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a57189f7539b74008e2f267874203ec14">process_capabilities_request</a>()</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    {</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        $service_bodies = $this-&gt;server-&gt;GetServiceBodyArray();</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        </div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        <span class="comment">// We will fill these three arrays, depending on the users&#39; rights for a given Service body.</span></div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        $my_meeting_observer_service_bodies = array();</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        $my_meeting_editor_service_bodies = array();</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        $my_editable_service_bodies = array();</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        </div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        $user_obj = $this-&gt;server-&gt;GetCurrentUserObj();</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;            <span class="comment">// We cycle through all the Service bodies, and look for ones in which we have permissions.</span></div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            <span class="comment">// We use the Service body IDs to key them in associative arrays.</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            <span class="keywordflow">foreach</span> ($service_bodies as $service_body) {</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                <span class="keywordflow">if</span> (($user_obj-&gt;GetUserLevel() == <a class="code" href="../../df/d40/c__comdef__user_8class_8php.html#a813a0d07af6641590beaf373222f51a2">_USER_LEVEL_SERVICE_BODY_ADMIN</a>) &amp;&amp; $service_body-&gt;UserCanEdit()) { <span class="comment">// We are a full Service body editor, with rights to edit the Service body itself (as well as all its meetings).</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                    $my_editable_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()] = $service_body;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                } elseif ((($user_obj-&gt;GetUserLevel() == <a class="code" href="../../df/d40/c__comdef__user_8class_8php.html#a813a0d07af6641590beaf373222f51a2">_USER_LEVEL_SERVICE_BODY_ADMIN</a>) || ($user_obj-&gt;GetUserLevel() == <a class="code" href="../../df/d40/c__comdef__user_8class_8php.html#ac761e512fea213a1db42c4023c3f9f83">_USER_LEVEL_OBSERVER</a>)) &amp;&amp; $service_body-&gt;UserCanObserve()) { <span class="comment">// We are a &quot;guest&quot; editor, or an observer (depends on our user level).</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                    <span class="comment">// Again, we keep checking credentials, over and over again.</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                    <span class="keywordflow">if</span> ($user_obj-&gt;GetUserLevel() == <a class="code" href="../../df/d40/c__comdef__user_8class_8php.html#ac761e512fea213a1db42c4023c3f9f83">_USER_LEVEL_OBSERVER</a>) {</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                        $my_meeting_observer_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()] = $service_body;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                    } elseif ($service_body-&gt;UserCanEditMeetings()) {</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                        $my_meeting_editor_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()] = $service_body;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                    }</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                }</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;            }</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;            <span class="comment">// Now, we grant rights to Service bodies that are implicit from other rights (for example, a Service Body Admin can also observe and edit meetings).</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            </div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            <span class="comment">// A full Service Body Admin can edit meetings in that Service body.</span></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            <span class="keywordflow">foreach</span> ($my_editable_service_bodies as $service_body) {</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                $my_meeting_editor_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()] = $service_body;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            }</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            </div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            <span class="comment">// An editor (whether an admin or a &quot;guest&quot;) also has observe rights.</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            <span class="keywordflow">foreach</span> ($my_meeting_editor_service_bodies as $service_body) {</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                $my_meeting_observer_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()] = $service_body;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            }</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            </div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            <span class="comment">// At this point, we have 3 arrays (or fewer), filled with Service bodies that we have rights on. It is entirely possible that only one of them could be filled, and it may only have one member.</span></div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            </div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            <span class="comment">// We start to construct the XML filler.</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            <span class="keywordflow">foreach</span> ($service_bodies as $service_body) {</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                <span class="comment">// If we can observe, then we have at least one permission for this Service body.</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                <span class="keywordflow">if</span> (isset($my_meeting_observer_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()]) &amp;&amp; $my_meeting_observer_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()]) {</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&lt;service_body id=&quot;&#39;</span>.$service_body-&gt;GetID().<span class="stringliteral">&#39;&quot; name=&quot;&#39;</span>.<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($service_body-&gt;GetLocalName()).<span class="stringliteral">&#39;&quot; permissions=&quot;&#39;</span>;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                    <span class="keywordflow">if</span> (isset($my_editable_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()]) &amp;&amp; $my_editable_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()]) {</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="charliteral">&#39;3&#39;</span>;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                    } elseif (isset($my_meeting_editor_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()]) &amp;&amp; $my_meeting_editor_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()]) {</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="charliteral">&#39;2&#39;</span>;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                    } elseif (isset($my_meeting_observer_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()]) &amp;&amp; $my_meeting_observer_service_bodies[<span class="stringliteral">&#39;sb_&#39;</span>.$service_body-&gt;GetID()]) {</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="charliteral">&#39;1&#39;</span>;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="charliteral">&#39;0&#39;</span>;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                    }</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                    <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> .= <span class="stringliteral">&#39;&quot;/&gt;&#39;</span>;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                }</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            }</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            <span class="comment">// Create a proper XML wrapper for the response data.</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;permissions xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/AdminPermissions.php\&quot;&gt;$ret&lt;/permissions&gt;&quot;</span>;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;            <span class="comment">// We now have XML that states the current user&#39;s permission levels in all Service bodies.</span></div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        }</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        </div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    }</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="comment">/********************************************************************************************************/</span><span class="comment">/**</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="comment">    \brief This fulfills a user request to return the current users info.</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="comment">    \returns XML, containing the answer.</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="comment">     ************************************************************************************************************/</span></div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01824"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a0656ff4bbc90c9fdd2e7bb9cfb270b46"> 1824</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a0656ff4bbc90c9fdd2e7bb9cfb270b46">process_user_info</a>()</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    {</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&#39;</span>;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        $user_obj = $this-&gt;server-&gt;GetCurrentUserObj();</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;basic_user_validation()) {</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;current_user id=&quot;&#39;</span>.$user_obj-&gt;GetID().<span class="stringliteral">&#39;&quot; name=&quot;&#39;</span>.<a class="code" href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a>($user_obj-&gt;GetLocalName()).<span class="stringliteral">&#39;&quot; type=&quot;&#39;</span> . $user_obj-&gt;GetUserLevel() . <span class="stringliteral">&#39;&quot;/&gt;&#39;</span>;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            <span class="comment">// Create a proper XML wrapper for the response data.</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;user_info xmlns=\&quot;http://&quot;</span>.c_comdef_htmlspecialchars($_SERVER[<span class="stringliteral">&#39;SERVER_NAME&#39;</span>]).<span class="stringliteral">&quot;\&quot; xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:schemaLocation=\&quot;&quot;</span>.$this-&gt;getMainURL().<span class="stringliteral">&quot;client_interface/xsd/UserInfo.php\&quot;&gt;$ret&lt;/user_info&gt;&quot;</span>;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            <span class="comment">// We now have XML that states the current user&#39;s permission levels in all Service bodies.</span></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;            <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a> = <span class="stringliteral">&#39;&lt;h1&gt;NOT AUTHORIZED&lt;/h1&gt;&#39;</span>;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        }</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a>;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    }</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="comment">/*******************************************************************/</span><span class="comment"></span></div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment">        \brief Translates CSV to XML.</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment">        \returns an XML string, with all the data in the CSV.</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="comment">// phpcs:disable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01849"></a><span class="lineno"><a class="line" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#acd74323e384e5dc3b6b33008df5464bf"> 1849</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/dc3/classc__comdef__admin__xml__handler.html#acd74323e384e5dc3b6b33008df5464bf">TranslateCSVToXML</a>(    $in_csv_data    <span class="comment">///&lt; An array of CSV data, with the first element being the field names.</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="comment"></span>                                )</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    {</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        <span class="comment">// phpcs:enable PSR1.Methods.CamelCapsMethodName.NotCamelCaps</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        require_once(dirname(dirname(dirname(__FILE__))).<span class="stringliteral">&#39;/server/shared/Array2XML.php&#39;</span>);</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        $temp_keyed_array = array();</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        $in_csv_data = explode(<span class="stringliteral">&quot;\n&quot;</span>, $in_csv_data);</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        $keys = array_shift($in_csv_data);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        $keys = rtrim(ltrim($keys, <span class="charliteral">&#39;&quot;&#39;</span>), <span class="stringliteral">&#39;&quot;,&#39;</span>);</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        $keys = preg_split(<span class="stringliteral">&#39;/&quot;,&quot;/&#39;</span>, $keys);</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    </div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <span class="keywordflow">foreach</span> ($in_csv_data as $row) {</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            <span class="keywordflow">if</span> ($row) {</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                $line = null;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                $index = 0;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                $row_t = rtrim(ltrim($row, <span class="charliteral">&#39;&quot;&#39;</span>), <span class="stringliteral">&#39;&quot;,&#39;</span>);</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                $row_t = preg_split(<span class="stringliteral">&#39;/&quot;,&quot;/&#39;</span>, $row_t);</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                <span class="keywordflow">foreach</span> ($row_t as $column) {</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                    <span class="keywordflow">if</span> (isset($column)) {</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                        $line[$keys[$index++]] = trim($column);</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                    }</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                }</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                array_push($temp_keyed_array, $line);</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;            }</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        }</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        $out_xml_data = <a class="code" href="../../d5/d68/Array2XML_8php.html#a8469178334d4a06d03e57c96fe9d0c99">array2xml</a>($temp_keyed_array, <span class="stringliteral">&#39;not_used&#39;</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        <span class="keywordflow">return</span> $out_xml_data;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    }</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;}</div><div class="ttc" id="classc__comdef__service__body_html"><div class="ttname"><a href="../../d1/dff/classc__comdef__service__body.html">c_comdef_service_body</a></div><div class="ttdoc">A Class for Service Body Objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d6a/c__comdef__service__body_8class_8php_source.html#l00058">c_comdef_service_body.class.php:58</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a0656ff4bbc90c9fdd2e7bb9cfb270b46"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a0656ff4bbc90c9fdd2e7bb9cfb270b46">c_comdef_admin_xml_handler\process_user_info</a></div><div class="ttdeci">process_user_info()</div><div class="ttdoc">This fulfills a user request to return the current users info. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l01824">c_comdef_admin_xml_handler.class.php:1824</a></div></div>
<div class="ttc" id="classc__comdef__meeting_html"><div class="ttname"><a href="../../d9/dcc/classc__comdef__meeting.html">c_comdef_meeting</a></div><div class="ttdoc">A class to hold a single meeting object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d10/c__comdef__meeting_8class_8php_source.html#l00050">c_comdef_meeting.class.php:50</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a4fc8d3a76e1dc1b940621027fadc4dd4"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a4fc8d3a76e1dc1b940621027fadc4dd4">c_comdef_admin_xml_handler\$handled_service_body_ids</a></div><div class="ttdeci">$handled_service_body_ids</div><div class="ttdoc">This is used to ensure that we respect the hierarchy when doing a hierarchical Service body request...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00035">c_comdef_admin_xml_handler.class.php:35</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a57189f7539b74008e2f267874203ec14"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a57189f7539b74008e2f267874203ec14">c_comdef_admin_xml_handler\process_capabilities_request</a></div><div class="ttdeci">process_capabilities_request()</div><div class="ttdoc">This fulfills a user request to report the rights for the logged-in user. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l01750">c_comdef_admin_xml_handler.class.php:1750</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a0de444c38e9d5a1bf397ba278318b993"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a0de444c38e9d5a1bf397ba278318b993">c_comdef_admin_xml_handler\process_rollback_meeting</a></div><div class="ttdeci">process_rollback_meeting()</div><div class="ttdoc">This fulfills a user request to restore a single deleted meeting. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00325">c_comdef_admin_xml_handler.class.php:325</a></div></div>
<div class="ttc" id="classc__comdef__meeting_html_a25371b1b5d4d3c016fe90ad6708deeb3"><div class="ttname"><a href="../../d9/dcc/classc__comdef__meeting.html#a25371b1b5d4d3c016fe90ad6708deeb3">c_comdef_meeting\GetAllMeetingKeys</a></div><div class="ttdeci">static GetAllMeetingKeys()</div><div class="ttdoc">Returns an array of strings, containing the keys (table columns) used for all meetings (specified in ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d10/c__comdef__meeting_8class_8php_source.html#l00617">c_comdef_meeting.class.php:617</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a166dfd988cdd152db9f360e09c040db8"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a166dfd988cdd152db9f360e09c040db8">c_comdef_admin_xml_handler\process_commands</a></div><div class="ttdeci">process_commands()</div><div class="ttdoc">This is called to process the input and generate the output. It is the &quot;heart&quot; of the class...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00152">c_comdef_admin_xml_handler.class.php:152</a></div></div>
<div class="ttc" id="classc__comdef__user_html"><div class="ttname"><a href="../../d4/de6/classc__comdef__user.html">c_comdef_user</a></div><div class="ttdoc">This class handles BMLT users. One instance is created for each user on the server. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d40/c__comdef__user_8class_8php_source.html#l00040">c_comdef_user.class.php:40</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a634e4fb3f0535a99050530167407ff87"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a634e4fb3f0535a99050530167407ff87">c_comdef_admin_xml_handler\$http_vars</a></div><div class="ttdeci">$http_vars</div><div class="ttdoc">This will hold the combined GET and POST parameters for this call. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00032">c_comdef_admin_xml_handler.class.php:32</a></div></div>
<div class="ttc" id="csv_8php_html_a10fdc8c4ebeef06534a9ebaf849c94ab"><div class="ttname"><a href="../../d6/d23/csv_8php.html#a10fdc8c4ebeef06534a9ebaf849c94ab">TranslateToXML</a></div><div class="ttdeci">TranslateToXML( $in_csv_data)</div><div class="ttdoc">Translates CSV to XML. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d23/csv_8php_source.html#l01489">csv.php:1489</a></div></div>
<div class="ttc" id="classc__comdef__server_html_aebc5d4fd6276a2a70fbbe1f7950ab356"><div class="ttname"><a href="../../dd/d45/classc__comdef__server.html#aebc5d4fd6276a2a70fbbe1f7950ab356">c_comdef_server\GetChangesFromIDAndType</a></div><div class="ttdeci">static GetChangesFromIDAndType( $in_type, $in_id=null, $in_start_date=null, $in_end_date=null)</div><div class="ttdoc">Gets a list of all change objects of a certain type, or only one, if the change affects a certain cla...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0c/c__comdef__server_8class_8php_source.html#l02312">c_comdef_server.class.php:2312</a></div></div>
<div class="ttc" id="contact_8php_html_affd9e3eb0aad0a7ca42912cd925f148c"><div class="ttname"><a href="../../df/d42/contact_8php.html#affd9e3eb0aad0a7ca42912cd925f148c">$ret</a></div><div class="ttdeci">$ret</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d42/contact_8php_source.html#l00226">contact.php:226</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a357d66d273dc1787a841e738668ba14e"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a357d66d273dc1787a841e738668ba14e">c_comdef_admin_xml_handler\getMainURL</a></div><div class="ttdeci">getMainURL()</div><div class="ttdoc">This returns the URL to the main server. It needs extra stripping, because we&amp;#39;re depper than usual...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00056">c_comdef_admin_xml_handler.class.php:56</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_ab2e4b3bdd2476f154bb881345ac2208a"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ab2e4b3bdd2476f154bb881345ac2208a">c_comdef_admin_xml_handler\process_deleted_meetings</a></div><div class="ttdeci">process_deleted_meetings()</div><div class="ttdoc">This fulfills a user request to delete a meeting. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00436">c_comdef_admin_xml_handler.class.php:436</a></div></div>
<div class="ttc" id="classc__comdef__meeting_html_a16359662661b48bab9729a15cd991ab5"><div class="ttname"><a href="../../d9/dcc/classc__comdef__meeting.html#a16359662661b48bab9729a15cd991ab5">c_comdef_meeting\GetLongDataTableTemplate</a></div><div class="ttdeci">static GetLongDataTableTemplate( $in_lang_enum=null)</div><div class="ttdoc">Returns an array that provides a template for the long data table values (the optional/additional val...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d10/c__comdef__meeting_8class_8php_source.html#l00936">c_comdef_meeting.class.php:936</a></div></div>
<div class="ttc" id="c__comdef__user_8class_8php_html_a813a0d07af6641590beaf373222f51a2"><div class="ttname"><a href="../../df/d40/c__comdef__user_8class_8php.html#a813a0d07af6641590beaf373222f51a2">_USER_LEVEL_SERVICE_BODY_ADMIN</a></div><div class="ttdeci">const _USER_LEVEL_SERVICE_BODY_ADMIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d40/c__comdef__user_8class_8php_source.html#l00028">c_comdef_user.class.php:28</a></div></div>
<div class="ttc" id="c__comdef__user_8class_8php_html_ac761e512fea213a1db42c4023c3f9f83"><div class="ttname"><a href="../../df/d40/c__comdef__user_8class_8php.html#ac761e512fea213a1db42c4023c3f9f83">_USER_LEVEL_OBSERVER</a></div><div class="ttdeci">const _USER_LEVEL_OBSERVER</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d40/c__comdef__user_8class_8php_source.html#l00031">c_comdef_user.class.php:31</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_ac76cee2da14025c6bfcec00757629fbb"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ac76cee2da14025c6bfcec00757629fbb">c_comdef_admin_xml_handler\process_get_field_templates</a></div><div class="ttdeci">process_get_field_templates()</div><div class="ttdoc">This fulfills a user request to get all the available fields for adding/modifying meeting data...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00965">c_comdef_admin_xml_handler.class.php:965</a></div></div>
<div class="ttc" id="contact_8php_html_a49d147e63a58f14bbd7211f6cd474958"><div class="ttname"><a href="../../df/d42/contact_8php.html#a49d147e63a58f14bbd7211f6cd474958">$meeting_id</a></div><div class="ttdeci">$meeting_id</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d42/contact_8php_source.html#l00227">contact.php:227</a></div></div>
<div class="ttc" id="c__comdef__user_8class_8php_html_a65106dc8c1c3bcd5c97f95a66caccf51"><div class="ttname"><a href="../../df/d40/c__comdef__user_8class_8php.html#a65106dc8c1c3bcd5c97f95a66caccf51">_USER_LEVEL_DISABLED</a></div><div class="ttdeci">const _USER_LEVEL_DISABLED</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d40/c__comdef__user_8class_8php_source.html#l00030">c_comdef_user.class.php:30</a></div></div>
<div class="ttc" id="search__results__csv_8php_html_a26e3d1e9f10048575aa522572279d6bd"><div class="ttname"><a href="../../da/d34/search__results__csv_8php.html#a26e3d1e9f10048575aa522572279d6bd">DisplaySearchResultsCSV</a></div><div class="ttdeci">DisplaySearchResultsCSV( $in_http_vars, &amp;$return_array=null, &amp;$return_geocode=null, &amp;$return_results=null, $in_supress_hidden_concat=false, $in_editor_only=false)</div><div class="ttdoc">This function does a search, then builds a CSV result, with each row being a meeting. The first row is a row of keys. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d34/search__results__csv_8php_source.html#l00108">search_results_csv.php:108</a></div></div>
<div class="ttc" id="csv_8php_html_afdce10070c62f12d732cf7c40e548a09"><div class="ttname"><a href="../../d6/d23/csv_8php.html#afdce10070c62f12d732cf7c40e548a09">GetFormats</a></div><div class="ttdeci">GetFormats(&amp;$server, $in_lang=null, $in_formats=null)</div><div class="ttdoc">This returns the complete formats table. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d23/csv_8php_source.html#l00893">csv.php:893</a></div></div>
<div class="ttc" id="comdef__utilityclasses_8inc_8php_html_a2b4b5d31847b34fe2fe62cf560342d01"><div class="ttname"><a href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a2b4b5d31847b34fe2fe62cf560342d01">GetURLToMainServerDirectory</a></div><div class="ttdeci">GetURLToMainServerDirectory( $inAllowHTTPS=true)</div><div class="ttdoc">Returns a URL (HTTP) to the main_server directory (or renamed). </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d45/comdef__utilityclasses_8inc_8php_source.html#l00020">comdef_utilityclasses.inc.php:20</a></div></div>
<div class="ttc" id="classc__comdef__server_html_a73c17efb58fc8625e47b151164c67ad4"><div class="ttname"><a href="../../dd/d45/classc__comdef__server.html#a73c17efb58fc8625e47b151164c67ad4">c_comdef_server\GetServer</a></div><div class="ttdeci">static GetServer()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0c/c__comdef__server_8class_8php_source.html#l00106">c_comdef_server.class.php:106</a></div></div>
<div class="ttc" id="c__comdef__user_8class_8php_html_a45f118b0120941c6f0099e0467bea854"><div class="ttname"><a href="../../df/d40/c__comdef__user_8class_8php.html#a45f118b0120941c6f0099e0467bea854">_USER_LEVEL_SERVER_ADMIN</a></div><div class="ttdeci">const _USER_LEVEL_SERVER_ADMIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d40/c__comdef__user_8class_8php_source.html#l00027">c_comdef_user.class.php:27</a></div></div>
<div class="ttc" id="classc__comdef__format_html"><div class="ttname"><a href="../../d9/db6/classc__comdef__format.html">c_comdef_format</a></div><div class="ttdoc">A Class for Format Codes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d16/c__comdef__format_8class_8php_source.html#l00037">c_comdef_format.class.php:37</a></div></div>
<div class="ttc" id="classc__comdef__server_html_a1ed8d51fee14cd90a6bd9915580317b1"><div class="ttname"><a href="../../dd/d45/classc__comdef__server.html#a1ed8d51fee14cd90a6bd9915580317b1">c_comdef_server\GetOneMeeting</a></div><div class="ttdeci">static GetOneMeeting( $in_id_bigint, $test_only=false)</div><div class="ttdoc">Given an ID for a meeting, it returns one instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0c/c__comdef__server_8class_8php_source.html#l01527">c_comdef_server.class.php:1527</a></div></div>
<div class="ttc" id="classc__comdef__server_html_ac3680235988649b237ff82be9541e3f3"><div class="ttname"><a href="../../dd/d45/classc__comdef__server.html#ac3680235988649b237ff82be9541e3f3">c_comdef_server\GetUserByIDObj</a></div><div class="ttdeci">static GetUserByIDObj( $in_user_id_bigint)</div><div class="ttdoc">Get the object for a single user, given an ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0c/c__comdef__server_8class_8php_source.html#l01180">c_comdef_server.class.php:1180</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a22375075ad60d382a134c7f3e430f7c3"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a22375075ad60d382a134c7f3e430f7c3">c_comdef_admin_xml_handler\process_meeting_search</a></div><div class="ttdeci">process_meeting_search()</div><div class="ttdoc">This fulfills a user request to return meeting information from a search. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l01373">c_comdef_admin_xml_handler.class.php:1373</a></div></div>
<div class="ttc" id="local__server_2index_8php_html_a634e4fb3f0535a99050530167407ff87"><div class="ttname"><a href="../../dd/da0/local__server_2index_8php.html#a634e4fb3f0535a99050530167407ff87">$http_vars</a></div><div class="ttdeci">global $http_vars</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da0/local__server_2index_8php_source.html#l00021">index.php:21</a></div></div>
<div class="ttc" id="comdef__utilityclasses_8inc_8php_html_a69d2ef2f8015dc970e6ffd175b1cb714"><div class="ttname"><a href="../../d0/d45/comdef__utilityclasses_8inc_8php.html#a69d2ef2f8015dc970e6ffd175b1cb714">c_comdef_htmlspecialchars</a></div><div class="ttdeci">c_comdef_htmlspecialchars($in_string)</div><div class="ttdoc">This function creates a displayable string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d45/comdef__utilityclasses_8inc_8php_source.html#l00395">comdef_utilityclasses.inc.php:395</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a7801e378d1267edc99d11e029f208acb"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a7801e378d1267edc99d11e029f208acb">c_comdef_admin_xml_handler\get_meeting_data</a></div><div class="ttdeci">get_meeting_data($meeting_id)</div><div class="ttdoc">This extracts a meeting&amp;#39;s essential data as XML. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00068">c_comdef_admin_xml_handler.class.php:68</a></div></div>
<div class="ttc" id="classc__comdef__server_html_af8fe64ccd359a4877fc04cd52ac9b938"><div class="ttname"><a href="../../dd/d45/classc__comdef__server.html#af8fe64ccd359a4877fc04cd52ac9b938">c_comdef_server\GetLocalStrings</a></div><div class="ttdeci">static GetLocalStrings( $in_lang_enum=null)</div><div class="ttdoc">This gets the appropriate language files, and puts all the the strings into an associative array...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0c/c__comdef__server_8class_8php_source.html#l02648">c_comdef_server.class.php:2648</a></div></div>
<div class="ttc" id="classc__comdef__server_html_aac85daa361f03562762940c543139cc5"><div class="ttname"><a href="../../dd/d45/classc__comdef__server.html#aac85daa361f03562762940c543139cc5">c_comdef_server\GetServiceBodyByIDObj</a></div><div class="ttdeci">static GetServiceBodyByIDObj( $in_service_body_id_bigint)</div><div class="ttdoc">Get the object for a single service body, given an ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0c/c__comdef__server_8class_8php_source.html#l01375">c_comdef_server.class.php:1375</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_aa8e8e214244815461ad2b762968f3549"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#aa8e8e214244815461ad2b762968f3549">c_comdef_admin_xml_handler\get_deleted_meetings_as_csv</a></div><div class="ttdeci">get_deleted_meetings_as_csv( $in_start_date=null, $in_end_date=null, $in_meeting_id=null, $in_user_id=null, $in_sb_id=null)</div><div class="ttdoc">This returns deleted meeting records in CSV form (which we turn into XML). </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00491">c_comdef_admin_xml_handler.class.php:491</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a42027b0fdb84434834455b4606d1b74e"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a42027b0fdb84434834455b4606d1b74e">c_comdef_admin_xml_handler\$my_localized_strings</a></div><div class="ttdeci">$my_localized_strings</div><div class="ttdoc">An array of localized strings. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00034">c_comdef_admin_xml_handler.class.php:34</a></div></div>
<div class="ttc" id="classc__comdef__change_html"><div class="ttname"><a href="../../d5/d79/classc__comdef__change.html">c_comdef_change</a></div><div class="ttdoc">A Class for Change Record Objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/c__comdef__change_8class_8php_source.html#l00044">c_comdef_change.class.php:44</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_abd668b301f7aa040d76226d633e3d0d0"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#abd668b301f7aa040d76226d633e3d0d0">c_comdef_admin_xml_handler\process_format_info</a></div><div class="ttdeci">process_format_info()</div><div class="ttdoc">This fulfills a user request to return format information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l01464">c_comdef_admin_xml_handler.class.php:1464</a></div></div>
<div class="ttc" id="classc__comdef__changes_html"><div class="ttname"><a href="../../d2/d5a/classc__comdef__changes.html">c_comdef_changes</a></div><div class="ttdoc">A class to hold a collection of c_comdef_change objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/daa/c__comdef__changes_8class_8php_source.html#l00032">c_comdef_changes.class.php:32</a></div></div>
<div class="ttc" id="classc__comdef__meeting_html_a9c5e90b04a6aa747dcda54dc0c7b708b"><div class="ttname"><a href="../../d9/dcc/classc__comdef__meeting.html#a9c5e90b04a6aa747dcda54dc0c7b708b">c_comdef_meeting\GetMainDataTemplate</a></div><div class="ttdeci">static GetMainDataTemplate()</div><div class="ttdoc">Returns an array that provides a template for the main table values (the standard values)...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d10/c__comdef__meeting_8class_8php_source.html#l00848">c_comdef_meeting.class.php:848</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a751759217c4c0c786276ee28ac1558d4"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a751759217c4c0c786276ee28ac1558d4">c_comdef_admin_xml_handler\__construct</a></div><div class="ttdeci">__construct( $in_http_vars, $in_server)</div><div class="ttdoc">The class constructor. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00040">c_comdef_admin_xml_handler.class.php:40</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a9785a33c1af65821ce08728a72d1b287"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a9785a33c1af65821ce08728a72d1b287">c_comdef_admin_xml_handler\process_meeting_modify</a></div><div class="ttdeci">process_meeting_modify()</div><div class="ttdoc">This fulfills a user request to modify fields in a meeting (or create a new meeting). This requires that the following HTTP parameters be set: </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l01073">c_comdef_admin_xml_handler.class.php:1073</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a016a5679ddad0ba55828e4dd3cb533d3"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a016a5679ddad0ba55828e4dd3cb533d3">c_comdef_admin_xml_handler\process_service_bodies_info_request</a></div><div class="ttdeci">process_service_bodies_info_request()</div><div class="ttdoc">This fulfills a user request to return Service Body information for multiple Service bodies...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l01543">c_comdef_admin_xml_handler.class.php:1543</a></div></div>
<div class="ttc" id="client__interface_2html_2index_8php_html_a9fbaf120043298ee46edd0722ca2d570"><div class="ttname"><a href="../../d5/d1d/client__interface_2html_2index_8php.html#a9fbaf120043298ee46edd0722ca2d570">defined</a></div><div class="ttdeci">defined( 'BMLT_EXEC') or define( 'BMLT_EXEC'</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d1d/client__interface_2html_2index_8php_source.html#l00003">index.php:3</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_acd74323e384e5dc3b6b33008df5464bf"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#acd74323e384e5dc3b6b33008df5464bf">c_comdef_admin_xml_handler\TranslateCSVToXML</a></div><div class="ttdeci">TranslateCSVToXML( $in_csv_data)</div><div class="ttdoc">Translates CSV to XML. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l01849">c_comdef_admin_xml_handler.class.php:1849</a></div></div>
<div class="ttc" id="Array2XML_8php_html_a8469178334d4a06d03e57c96fe9d0c99"><div class="ttname"><a href="../../d5/d68/Array2XML_8php.html#a8469178334d4a06d03e57c96fe9d0c99">array2xml</a></div><div class="ttdeci">array2xml( $array, $name='array', $beginning=true)</div><div class="ttdoc">array2xml() will convert any given array into a XML structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d68/Array2XML_8php_source.html#l00038">Array2XML.php:38</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a04e8695d7c50cc7aae7d443c729ebf25"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a04e8695d7c50cc7aae7d443c729ebf25">c_comdef_admin_xml_handler\process_meeting_delete</a></div><div class="ttdeci">process_meeting_delete()</div><div class="ttdoc">This fulfills a user request to delete an existing meeting. $this-&gt;http_vars[&amp;#39;meeting_id&amp;#39;] must be se...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l01026">c_comdef_admin_xml_handler.class.php:1026</a></div></div>
<div class="ttc" id="classc__comdef__meeting_html_a9a652f869f5b68a517fbff83b81f9d24"><div class="ttname"><a href="../../d9/dcc/classc__comdef__meeting.html#a9a652f869f5b68a517fbff83b81f9d24">c_comdef_meeting\GetDataTableTemplate</a></div><div class="ttdeci">static GetDataTableTemplate()</div><div class="ttdoc">Returns an array that provides a template for the data table values (the optional/additional values)...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d10/c__comdef__meeting_8class_8php_source.html#l00890">c_comdef_meeting.class.php:890</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_acb6ac99c5ba9e91df910bb9febaec2b6"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#acb6ac99c5ba9e91df910bb9febaec2b6">c_comdef_admin_xml_handler\process_changes</a></div><div class="ttdeci">process_changes()</div><div class="ttdoc">This fulfills a user request to get change records. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00274">c_comdef_admin_xml_handler.class.php:274</a></div></div>
<div class="ttc" id="config-bmlt-basic_8inc_8php_html_ad135cc8a47e55f0829949cf62214170f"><div class="ttname"><a href="../../d4/dae/config-bmlt-basic_8inc_8php.html#ad135cc8a47e55f0829949cf62214170f">$server</a></div><div class="ttdeci">$server</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dae/config-bmlt-basic_8inc_8php_source.html#l00033">config-bmlt-basic.inc.php:33</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a87ee72103e36de70b6e65c83b84fb7de"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a87ee72103e36de70b6e65c83b84fb7de">c_comdef_admin_xml_handler\process_restore_deleted_meeting</a></div><div class="ttdeci">process_restore_deleted_meeting()</div><div class="ttdoc">This fulfills a user request to restore a single deleted meeting. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00378">c_comdef_admin_xml_handler.class.php:378</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_ad135cc8a47e55f0829949cf62214170f"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ad135cc8a47e55f0829949cf62214170f">c_comdef_admin_xml_handler\$server</a></div><div class="ttdeci">$server</div><div class="ttdoc">The BMLT server model instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00033">c_comdef_admin_xml_handler.class.php:33</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_a6a4573ed1ae18f06dcedcd952d2bf217"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#a6a4573ed1ae18f06dcedcd952d2bf217">c_comdef_admin_xml_handler\process_service_body_info_request</a></div><div class="ttdeci">process_service_body_info_request( $in_service_body_id)</div><div class="ttdoc">This fulfills a user request to return Service Body information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l01594">c_comdef_admin_xml_handler.class.php:1594</a></div></div>
<div class="ttc" id="classc__comdef__server_html_a11a015e9f4fcf09893c17d8a3e6504b3"><div class="ttname"><a href="../../dd/d45/classc__comdef__server.html#a11a015e9f4fcf09893c17d8a3e6504b3">c_comdef_server\GetMeetingsByID</a></div><div class="ttdeci">static GetMeetingsByID( $in_id_bigint_array)</div><div class="ttdoc">Get a series of meetings, each identified by an ID. This does not filter by any of the other major cr...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0c/c__comdef__server_8class_8php_source.html#l01638">c_comdef_server.class.php:1638</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_afb31a84cb5e63ed4dac58c9271982164"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#afb31a84cb5e63ed4dac58c9271982164">c_comdef_admin_xml_handler\get_changes_as_csv</a></div><div class="ttdeci">get_changes_as_csv( $in_start_date=null, $in_end_date=null, $in_meeting_id=null, $in_user_id=null, $in_sb_id=null, $in_change_type='c_comdef_meeting')</div><div class="ttdoc">This returns change records in CSV form (which we turn into XML). </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00737">c_comdef_admin_xml_handler.class.php:737</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html_ad530d8c4d6f9b53b9ce180cd8cacdf39"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html#ad530d8c4d6f9b53b9ce180cd8cacdf39">c_comdef_admin_xml_handler\basic_user_validation</a></div><div class="ttdeci">basic_user_validation()</div><div class="ttdoc">This is a basic funtion that tests the current user, to see if they are basically valid...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00254">c_comdef_admin_xml_handler.class.php:254</a></div></div>
<div class="ttc" id="classc__comdef__server_html_a6f7213b38b189bdfdf39248f1f64190a"><div class="ttname"><a href="../../dd/d45/classc__comdef__server.html#a6f7213b38b189bdfdf39248f1f64190a">c_comdef_server\AddNewMeeting</a></div><div class="ttdeci">static AddNewMeeting( $in_service_body_bigint, $in_weekday_tinyint, $in_start_time_int, $in_lang_enum)</div><div class="ttdoc">Creates a new, relatively empty meeting in the database, with no data fields and minimal information...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0c/c__comdef__server_8class_8php_source.html#l00806">c_comdef_server.class.php:806</a></div></div>
<div class="ttc" id="classc__comdef__admin__xml__handler_html"><div class="ttname"><a href="../../d4/dc3/classc__comdef__admin__xml__handler.html">c_comdef_admin_xml_handler</a></div><div class="ttdoc">Controls handling of the admin semantic interface. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8d/c__comdef__admin__xml__handler_8class_8php_source.html#l00028">c_comdef_admin_xml_handler.class.php:28</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Aug 6 2019 07:01:54 for BMLT Root Server by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
